{"cells":[{"cell_type":"markdown","source":["# **IMPORT LIBRARIES**"],"metadata":{"id":"rfE2a5LqSsNW"}},{"cell_type":"code","source":["import pandas as pd\n","from datetime import datetime"],"metadata":{"id":"-919rKK2SwJP","executionInfo":{"status":"ok","timestamp":1684137139816,"user_tz":-540,"elapsed":4,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"execution_count":6,"outputs":[]},{"cell_type":"code","source":["!pip install yfinance"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"VnO3uYy_UQjN","executionInfo":{"status":"ok","timestamp":1684137144109,"user_tz":-540,"elapsed":4296,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}},"outputId":"3dd52a8c-505d-4900-c85b-0da474797fc5"},"execution_count":7,"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Requirement already satisfied: yfinance in /usr/local/lib/python3.10/dist-packages (0.2.18)\n","Requirement already satisfied: pandas>=1.3.0 in /usr/local/lib/python3.10/dist-packages (from yfinance) (1.5.3)\n","Requirement already satisfied: numpy>=1.16.5 in /usr/local/lib/python3.10/dist-packages (from yfinance) (1.22.4)\n","Requirement already satisfied: requests>=2.26 in /usr/local/lib/python3.10/dist-packages (from yfinance) (2.27.1)\n","Requirement already satisfied: multitasking>=0.0.7 in /usr/local/lib/python3.10/dist-packages (from yfinance) (0.0.11)\n","Requirement already satisfied: lxml>=4.9.1 in /usr/local/lib/python3.10/dist-packages (from yfinance) (4.9.2)\n","Requirement already satisfied: appdirs>=1.4.4 in /usr/local/lib/python3.10/dist-packages (from yfinance) (1.4.4)\n","Requirement already satisfied: pytz>=2022.5 in /usr/local/lib/python3.10/dist-packages (from yfinance) (2022.7.1)\n","Requirement already satisfied: frozendict>=2.3.4 in /usr/local/lib/python3.10/dist-packages (from yfinance) (2.3.7)\n","Requirement already satisfied: cryptography>=3.3.2 in /usr/local/lib/python3.10/dist-packages (from yfinance) (40.0.2)\n","Requirement already satisfied: beautifulsoup4>=4.11.1 in /usr/local/lib/python3.10/dist-packages (from yfinance) (4.11.2)\n","Requirement already satisfied: html5lib>=1.1 in /usr/local/lib/python3.10/dist-packages (from yfinance) (1.1)\n","Requirement already satisfied: soupsieve>1.2 in /usr/local/lib/python3.10/dist-packages (from beautifulsoup4>=4.11.1->yfinance) (2.4.1)\n","Requirement already satisfied: cffi>=1.12 in /usr/local/lib/python3.10/dist-packages (from cryptography>=3.3.2->yfinance) (1.15.1)\n","Requirement already satisfied: six>=1.9 in /usr/local/lib/python3.10/dist-packages (from html5lib>=1.1->yfinance) (1.16.0)\n","Requirement already satisfied: webencodings in /usr/local/lib/python3.10/dist-packages (from html5lib>=1.1->yfinance) (0.5.1)\n","Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.3.0->yfinance) (2.8.2)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.26->yfinance) (1.26.15)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.26->yfinance) (2022.12.7)\n","Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.10/dist-packages (from requests>=2.26->yfinance) (2.0.12)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.26->yfinance) (3.4)\n","Requirement already satisfied: pycparser in /usr/local/lib/python3.10/dist-packages (from cffi>=1.12->cryptography>=3.3.2->yfinance) (2.21)\n","Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Requirement already satisfied: yfinance in /usr/local/lib/python3.10/dist-packages (0.2.18)\n","Requirement already satisfied: pandas>=1.3.0 in /usr/local/lib/python3.10/dist-packages (from yfinance) (1.5.3)\n","Requirement already satisfied: numpy>=1.16.5 in /usr/local/lib/python3.10/dist-packages (from yfinance) (1.22.4)\n","Requirement already satisfied: requests>=2.26 in /usr/local/lib/python3.10/dist-packages (from yfinance) (2.27.1)\n","Requirement already satisfied: multitasking>=0.0.7 in /usr/local/lib/python3.10/dist-packages (from yfinance) (0.0.11)\n","Requirement already satisfied: lxml>=4.9.1 in /usr/local/lib/python3.10/dist-packages (from yfinance) (4.9.2)\n","Requirement already satisfied: appdirs>=1.4.4 in /usr/local/lib/python3.10/dist-packages (from yfinance) (1.4.4)\n","Requirement already satisfied: pytz>=2022.5 in /usr/local/lib/python3.10/dist-packages (from yfinance) (2022.7.1)\n","Requirement already satisfied: frozendict>=2.3.4 in /usr/local/lib/python3.10/dist-packages (from yfinance) (2.3.7)\n","Requirement already satisfied: cryptography>=3.3.2 in /usr/local/lib/python3.10/dist-packages (from yfinance) (40.0.2)\n","Requirement already satisfied: beautifulsoup4>=4.11.1 in /usr/local/lib/python3.10/dist-packages (from yfinance) (4.11.2)\n","Requirement already satisfied: html5lib>=1.1 in /usr/local/lib/python3.10/dist-packages (from yfinance) (1.1)\n","Requirement already satisfied: soupsieve>1.2 in /usr/local/lib/python3.10/dist-packages (from beautifulsoup4>=4.11.1->yfinance) (2.4.1)\n","Requirement already satisfied: cffi>=1.12 in /usr/local/lib/python3.10/dist-packages (from cryptography>=3.3.2->yfinance) (1.15.1)\n","Requirement already satisfied: six>=1.9 in /usr/local/lib/python3.10/dist-packages (from html5lib>=1.1->yfinance) (1.16.0)\n","Requirement already satisfied: webencodings in /usr/local/lib/python3.10/dist-packages (from html5lib>=1.1->yfinance) (0.5.1)\n","Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.3.0->yfinance) (2.8.2)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.26->yfinance) (1.26.15)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.26->yfinance) (2022.12.7)\n","Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.10/dist-packages (from requests>=2.26->yfinance) (2.0.12)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.26->yfinance) (3.4)\n","Requirement already satisfied: pycparser in /usr/local/lib/python3.10/dist-packages (from cffi>=1.12->cryptography>=3.3.2->yfinance) (2.21)\n"]}]},{"cell_type":"code","source":["!pip install pandas-ta"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"NtCSl_AwUc2e","executionInfo":{"status":"ok","timestamp":1684137150055,"user_tz":-540,"elapsed":5957,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}},"outputId":"69787853-bd62-4342-9d83-9d2254e496ba"},"execution_count":8,"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Requirement already satisfied: pandas-ta in /usr/local/lib/python3.10/dist-packages (0.3.14b0)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from pandas-ta) (1.5.3)\n","Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas->pandas-ta) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->pandas-ta) (2022.7.1)\n","Requirement already satisfied: numpy>=1.21.0 in /usr/local/lib/python3.10/dist-packages (from pandas->pandas-ta) (1.22.4)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.1->pandas->pandas-ta) (1.16.0)\n","Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Requirement already satisfied: pandas-ta in /usr/local/lib/python3.10/dist-packages (0.3.14b0)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from pandas-ta) (1.5.3)\n","Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas->pandas-ta) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->pandas-ta) (2022.7.1)\n","Requirement already satisfied: numpy>=1.21.0 in /usr/local/lib/python3.10/dist-packages (from pandas->pandas-ta) (1.22.4)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.1->pandas->pandas-ta) (1.16.0)\n"]}]},{"cell_type":"code","source":["import numpy as np\n","import pandas as pd\n","import yfinance as yf\n","import pandas_ta as ta\n","import matplotlib.pyplot as plt\n","import seaborn as sn"],"metadata":{"id":"F3cgeFMdUSq-","executionInfo":{"status":"ok","timestamp":1684137150056,"user_tz":-540,"elapsed":14,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"execution_count":9,"outputs":[]},{"cell_type":"code","source":["from sklearn.model_selection import train_test_split\n","from sklearn.preprocessing import MinMaxScaler\n","from sklearn.svm import SVC\n","from sklearn.metrics import confusion_matrix, classification_report, accuracy_score, f1_score"],"metadata":{"id":"_ATpLN8uUdYX","executionInfo":{"status":"ok","timestamp":1684137150056,"user_tz":-540,"elapsed":13,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"execution_count":10,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"gEOAoVb26JRg"},"source":["# **SA-FINBERT-SVM**"]},{"cell_type":"code","execution_count":11,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":420},"id":"umJ6hoFdXw-z","executionInfo":{"status":"ok","timestamp":1684138151005,"user_tz":-540,"elapsed":1000961,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}},"outputId":"7d995927-f4ea-43be-dd1d-bf9885513909"},"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","     <input type=\"file\" id=\"files-ef1a6b70-48f4-4a4d-bd99-5e2d46e3cc3f\" name=\"files[]\" multiple disabled\n","        style=\"border:none\" />\n","     <output id=\"result-ef1a6b70-48f4-4a4d-bd99-5e2d46e3cc3f\">\n","      Upload widget is only available when the cell has been executed in the\n","      current browser session. Please rerun this cell to enable.\n","      </output>\n","      <script>// Copyright 2017 Google LLC\n","//\n","// Licensed under the Apache License, Version 2.0 (the \"License\");\n","// you may not use this file except in compliance with the License.\n","// You may obtain a copy of the License at\n","//\n","//      http://www.apache.org/licenses/LICENSE-2.0\n","//\n","// Unless required by applicable law or agreed to in writing, software\n","// distributed under the License is distributed on an \"AS IS\" BASIS,\n","// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n","// See the License for the specific language governing permissions and\n","// limitations under the License.\n","\n","/**\n"," * @fileoverview Helpers for google.colab Python module.\n"," */\n","(function(scope) {\n","function span(text, styleAttributes = {}) {\n","  const element = document.createElement('span');\n","  element.textContent = text;\n","  for (const key of Object.keys(styleAttributes)) {\n","    element.style[key] = styleAttributes[key];\n","  }\n","  return element;\n","}\n","\n","// Max number of bytes which will be uploaded at a time.\n","const MAX_PAYLOAD_SIZE = 100 * 1024;\n","\n","function _uploadFiles(inputId, outputId) {\n","  const steps = uploadFilesStep(inputId, outputId);\n","  const outputElement = document.getElementById(outputId);\n","  // Cache steps on the outputElement to make it available for the next call\n","  // to uploadFilesContinue from Python.\n","  outputElement.steps = steps;\n","\n","  return _uploadFilesContinue(outputId);\n","}\n","\n","// This is roughly an async generator (not supported in the browser yet),\n","// where there are multiple asynchronous steps and the Python side is going\n","// to poll for completion of each step.\n","// This uses a Promise to block the python side on completion of each step,\n","// then passes the result of the previous step as the input to the next step.\n","function _uploadFilesContinue(outputId) {\n","  const outputElement = document.getElementById(outputId);\n","  const steps = outputElement.steps;\n","\n","  const next = steps.next(outputElement.lastPromiseValue);\n","  return Promise.resolve(next.value.promise).then((value) => {\n","    // Cache the last promise value to make it available to the next\n","    // step of the generator.\n","    outputElement.lastPromiseValue = value;\n","    return next.value.response;\n","  });\n","}\n","\n","/**\n"," * Generator function which is called between each async step of the upload\n"," * process.\n"," * @param {string} inputId Element ID of the input file picker element.\n"," * @param {string} outputId Element ID of the output display.\n"," * @return {!Iterable<!Object>} Iterable of next steps.\n"," */\n","function* uploadFilesStep(inputId, outputId) {\n","  const inputElement = document.getElementById(inputId);\n","  inputElement.disabled = false;\n","\n","  const outputElement = document.getElementById(outputId);\n","  outputElement.innerHTML = '';\n","\n","  const pickedPromise = new Promise((resolve) => {\n","    inputElement.addEventListener('change', (e) => {\n","      resolve(e.target.files);\n","    });\n","  });\n","\n","  const cancel = document.createElement('button');\n","  inputElement.parentElement.appendChild(cancel);\n","  cancel.textContent = 'Cancel upload';\n","  const cancelPromise = new Promise((resolve) => {\n","    cancel.onclick = () => {\n","      resolve(null);\n","    };\n","  });\n","\n","  // Wait for the user to pick the files.\n","  const files = yield {\n","    promise: Promise.race([pickedPromise, cancelPromise]),\n","    response: {\n","      action: 'starting',\n","    }\n","  };\n","\n","  cancel.remove();\n","\n","  // Disable the input element since further picks are not allowed.\n","  inputElement.disabled = true;\n","\n","  if (!files) {\n","    return {\n","      response: {\n","        action: 'complete',\n","      }\n","    };\n","  }\n","\n","  for (const file of files) {\n","    const li = document.createElement('li');\n","    li.append(span(file.name, {fontWeight: 'bold'}));\n","    li.append(span(\n","        `(${file.type || 'n/a'}) - ${file.size} bytes, ` +\n","        `last modified: ${\n","            file.lastModifiedDate ? file.lastModifiedDate.toLocaleDateString() :\n","                                    'n/a'} - `));\n","    const percent = span('0% done');\n","    li.appendChild(percent);\n","\n","    outputElement.appendChild(li);\n","\n","    const fileDataPromise = new Promise((resolve) => {\n","      const reader = new FileReader();\n","      reader.onload = (e) => {\n","        resolve(e.target.result);\n","      };\n","      reader.readAsArrayBuffer(file);\n","    });\n","    // Wait for the data to be ready.\n","    let fileData = yield {\n","      promise: fileDataPromise,\n","      response: {\n","        action: 'continue',\n","      }\n","    };\n","\n","    // Use a chunked sending to avoid message size limits. See b/62115660.\n","    let position = 0;\n","    do {\n","      const length = Math.min(fileData.byteLength - position, MAX_PAYLOAD_SIZE);\n","      const chunk = new Uint8Array(fileData, position, length);\n","      position += length;\n","\n","      const base64 = btoa(String.fromCharCode.apply(null, chunk));\n","      yield {\n","        response: {\n","          action: 'append',\n","          file: file.name,\n","          data: base64,\n","        },\n","      };\n","\n","      let percentDone = fileData.byteLength === 0 ?\n","          100 :\n","          Math.round((position / fileData.byteLength) * 100);\n","      percent.textContent = `${percentDone}% done`;\n","\n","    } while (position < fileData.byteLength);\n","  }\n","\n","  // All done.\n","  yield {\n","    response: {\n","      action: 'complete',\n","    }\n","  };\n","}\n","\n","scope.google = scope.google || {};\n","scope.google.colab = scope.google.colab || {};\n","scope.google.colab._files = {\n","  _uploadFiles,\n","  _uploadFilesContinue,\n","};\n","})(self);\n","</script> "]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Saving EUcentralbank_finBert.csv to EUcentralbank_finBert.csv\n","Saving EUinflation_finBert.csv to EUinflation_finBert.csv\n","Saving EUinterestrate_finBert.csv to EUinterestrate_finBert.csv\n","Saving EUrecession_finBert.csv to EUrecession_finBert.csv\n","Saving EUtax_finBert.csv to EUtax_finBert.csv\n","Saving macroeconomic_finBert.csv to macroeconomic_finBert.csv\n","Saving USFed_finBert.csv to USFed_finBert.csv\n","Saving USinflation_finBert.csv to USinflation_finBert.csv\n","Saving USinterestrate_finBert.csv to USinterestrate_finBert.csv\n","Saving USrecession2_finBert.csv to USrecession2_finBert.csv\n","Saving UStax_finBert.csv to UStax_finBert.csv\n"]}],"source":["from google.colab import files\n","files.upload()"]},{"cell_type":"markdown","metadata":{"id":"9Yuw8bQTa1fq"},"source":["## Loading Twitter sentiments"]},{"cell_type":"code","execution_count":12,"metadata":{"id":"DHR4B3aOrqLH","executionInfo":{"status":"ok","timestamp":1684138440068,"user_tz":-540,"elapsed":312,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["#tweet = pd.read_csv('USinflation_finBert.csv')"]},{"cell_type":"code","execution_count":13,"metadata":{"id":"MBpXhHbsYrMH","executionInfo":{"status":"ok","timestamp":1684138440535,"user_tz":-540,"elapsed":4,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["# tweet1 = pd.read_csv('Tweet-5_finBert.csv')\n","# tweet2 = pd.read_csv('Tweet-4_finBert.csv')\n","# tweet3 = pd.read_csv('Tweet-3_finBert.csv')\n","# tweet4 = pd.read_csv('Tweet-2_finBert.csv')\n","# tweet5 = pd.read_csv('Tweet-1_finBert.csv')\n","# tweet6 = pd.read_csv('Tweet1_finBert.csv')\n","# tweet7 = pd.read_csv('Tweet2_finBert.csv')\n","# tweet8 = pd.read_csv('Tweet3_finBert.csv')\n","# tweet9 = pd.read_csv('Tweet4_finBert.csv')\n","# tweet10 = pd.read_csv('Tweet5_finBert.csv')"]},{"cell_type":"code","execution_count":14,"metadata":{"id":"uVzHPKzdYxXM","executionInfo":{"status":"ok","timestamp":1684138440536,"user_tz":-540,"elapsed":4,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["# frames = [tweet1, tweet2, tweet3, tweet4, tweet5, tweet6, tweet7, tweet8, tweet9, tweet10]\n","# tweet=pd.concat(frames)"]},{"cell_type":"code","execution_count":15,"metadata":{"id":"L1UsVx7c1Oi4","executionInfo":{"status":"ok","timestamp":1684138442120,"user_tz":-540,"elapsed":1588,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["tweet1 = pd.read_csv('EUcentralbank_finBert.csv')\n","tweet2 = pd.read_csv('EUinflation_finBert.csv')\n","tweet3 = pd.read_csv('EUinterestrate_finBert.csv')\n","tweet4 = pd.read_csv('EUrecession_finBert.csv')\n","tweet5 = pd.read_csv('EUtax_finBert.csv')\n","tweet6 = pd.read_csv('macroeconomic_finBert.csv')\n","tweet7 = pd.read_csv('USFed_finBert.csv')\n","tweet8 = pd.read_csv('USinflation_finBert.csv')\n","tweet9 = pd.read_csv('USinterestrate_finBert.csv')\n","tweet10 = pd.read_csv('USrecession2_finBert.csv')\n","tweet11 = pd.read_csv('UStax_finBert.csv')"]},{"cell_type":"code","execution_count":16,"metadata":{"id":"Lip48uoP14uu","executionInfo":{"status":"ok","timestamp":1684138442121,"user_tz":-540,"elapsed":3,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["frames = [tweet1, tweet2, tweet3, tweet4, tweet5, tweet6, tweet7, tweet8, tweet9, tweet10, tweet11]\n","tweet=pd.concat(frames)"]},{"cell_type":"code","execution_count":17,"metadata":{"id":"WkfkPwGfY6M3","executionInfo":{"status":"ok","timestamp":1684138442518,"user_tz":-540,"elapsed":399,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["tweet['Date'] = pd.to_datetime(tweet['Date'], errors='coerce')\n","tweet['Date'] = tweet['Date'].dt.strftime('%Y-%m-%d')"]},{"cell_type":"code","execution_count":18,"metadata":{"id":"JK6MR2g3Y3-U","executionInfo":{"status":"ok","timestamp":1684138442518,"user_tz":-540,"elapsed":7,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["#del tweet[tweet.columns[0]]"]},{"cell_type":"code","execution_count":19,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"elapsed":7,"status":"ok","timestamp":1684138442519,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"},"user_tz":-540},"id":"TL_Us5wHY7w7","outputId":"aeef2623-85d6-4e0f-e8cf-ae1b8d4f6078"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["             Date             User  \\\n","0      2013-12-16            Habus   \n","1      2013-12-20      torvale1953   \n","2      2013-12-22   fortunepayment   \n","3      2013-12-24           nipped   \n","4      2013-12-27  skydbelltreatti   \n","...           ...              ...   \n","30102  2022-11-10  thatwhatmatters   \n","30103  2022-11-10     PhilipBritz3   \n","30104  2022-11-10       grahamh941   \n","30105  2022-11-10      OsgoodeIFLS   \n","30106  2022-11-10        no_in_red   \n","\n","                                                    twee sentiment  \n","0      eu central bank warns against the bitcoin comp...   neutral  \n","1      european central bank president mario draghi e...   neutral  \n","2      the european central bank ecb has created the ...   neutral  \n","3      small panic attack by the turkish central bank...   neutral  \n","4      details of eu iran sanctions covers oil compan...   neutral  \n","...                                                  ...       ...  \n","30102  only when shri  is coming to bengaluru  shri  ...   neutral  \n","30103  psastrike the right to strike is a mature poli...   neutral  \n","30104  bit of a long shot but does anyone have any ex...   neutral  \n","30105  does implementing canadadisabilitybenefit act ...  negative  \n","30106  doug ford is stealing billions of dollars from...  negative  \n","\n","[399855 rows x 4 columns]"],"text/html":["\n","  <div id=\"df-202c3021-5d23-4eb3-9833-5898bf401123\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Date</th>\n","      <th>User</th>\n","      <th>twee</th>\n","      <th>sentiment</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>2013-12-16</td>\n","      <td>Habus</td>\n","      <td>eu central bank warns against the bitcoin comp...</td>\n","      <td>neutral</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2013-12-20</td>\n","      <td>torvale1953</td>\n","      <td>european central bank president mario draghi e...</td>\n","      <td>neutral</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2013-12-22</td>\n","      <td>fortunepayment</td>\n","      <td>the european central bank ecb has created the ...</td>\n","      <td>neutral</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>2013-12-24</td>\n","      <td>nipped</td>\n","      <td>small panic attack by the turkish central bank...</td>\n","      <td>neutral</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>2013-12-27</td>\n","      <td>skydbelltreatti</td>\n","      <td>details of eu iran sanctions covers oil compan...</td>\n","      <td>neutral</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>30102</th>\n","      <td>2022-11-10</td>\n","      <td>thatwhatmatters</td>\n","      <td>only when shri  is coming to bengaluru  shri  ...</td>\n","      <td>neutral</td>\n","    </tr>\n","    <tr>\n","      <th>30103</th>\n","      <td>2022-11-10</td>\n","      <td>PhilipBritz3</td>\n","      <td>psastrike the right to strike is a mature poli...</td>\n","      <td>neutral</td>\n","    </tr>\n","    <tr>\n","      <th>30104</th>\n","      <td>2022-11-10</td>\n","      <td>grahamh941</td>\n","      <td>bit of a long shot but does anyone have any ex...</td>\n","      <td>neutral</td>\n","    </tr>\n","    <tr>\n","      <th>30105</th>\n","      <td>2022-11-10</td>\n","      <td>OsgoodeIFLS</td>\n","      <td>does implementing canadadisabilitybenefit act ...</td>\n","      <td>negative</td>\n","    </tr>\n","    <tr>\n","      <th>30106</th>\n","      <td>2022-11-10</td>\n","      <td>no_in_red</td>\n","      <td>doug ford is stealing billions of dollars from...</td>\n","      <td>negative</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>399855 rows × 4 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-202c3021-5d23-4eb3-9833-5898bf401123')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-202c3021-5d23-4eb3-9833-5898bf401123 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-202c3021-5d23-4eb3-9833-5898bf401123');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":19}],"source":["tweet"]},{"cell_type":"code","source":["tweet= tweet.sort_values(by=['Date'])"],"metadata":{"id":"5Y6vGGsQT1Hz","executionInfo":{"status":"ok","timestamp":1684138443015,"user_tz":-540,"elapsed":501,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"execution_count":20,"outputs":[]},{"cell_type":"code","execution_count":21,"metadata":{"id":"XBLfGjj9bEPU","executionInfo":{"status":"ok","timestamp":1684138443015,"user_tz":-540,"elapsed":4,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["# Drop duplicated tweets\n","tweet.drop_duplicates(subset='twee',inplace=True)"]},{"cell_type":"code","execution_count":22,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"elapsed":892,"status":"ok","timestamp":1684138443903,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"},"user_tz":-540},"id":"w3yCzy4sVaiA","outputId":"a3d83063-4f87-421c-deeb-c0d38b53af2f"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["              Date             User  \\\n","0       2013-12-16            Habus   \n","10      2013-12-16      Educ_Reform   \n","9       2013-12-16       TotesFacts   \n","8       2013-12-16          mrymler   \n","7       2013-12-16  KeithMcCullough   \n","...            ...              ...   \n","152080  2022-11-10       LTSummer22   \n","152079  2022-11-10           ajbell   \n","152078  2022-11-10    wheeliedealer   \n","152085  2022-11-10         alessiVT   \n","30106   2022-11-10        no_in_red   \n","\n","                                                     twee sentiment  \n","0       eu central bank warns against the bitcoin comp...   neutral  \n","10      is it a surprise that finance has not to date ...   neutral  \n","9       the cost of college textbooks in the us has ri...   neutral  \n","8       inb4 ala relax lah maryam the future will work...   neutral  \n","7       newsflash deflating the inflation in 2014 prov...   neutral  \n","...                                                   ...       ...  \n","152080  why cant my woke company give me a raise for i...   neutral  \n","152079   big day for us inflation figures whsmith rest...  positive  \n","152078  stocks looking bit soggy but nothing dramatic ...  negative  \n","152085  media reports many people are anxious about in...   neutral  \n","30106   doug ford is stealing billions of dollars from...  negative  \n","\n","[356396 rows x 4 columns]"],"text/html":["\n","  <div id=\"df-fc9b0f4d-a996-481a-b65c-f184e521c242\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Date</th>\n","      <th>User</th>\n","      <th>twee</th>\n","      <th>sentiment</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>2013-12-16</td>\n","      <td>Habus</td>\n","      <td>eu central bank warns against the bitcoin comp...</td>\n","      <td>neutral</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>2013-12-16</td>\n","      <td>Educ_Reform</td>\n","      <td>is it a surprise that finance has not to date ...</td>\n","      <td>neutral</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>2013-12-16</td>\n","      <td>TotesFacts</td>\n","      <td>the cost of college textbooks in the us has ri...</td>\n","      <td>neutral</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>2013-12-16</td>\n","      <td>mrymler</td>\n","      <td>inb4 ala relax lah maryam the future will work...</td>\n","      <td>neutral</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>2013-12-16</td>\n","      <td>KeithMcCullough</td>\n","      <td>newsflash deflating the inflation in 2014 prov...</td>\n","      <td>neutral</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>152080</th>\n","      <td>2022-11-10</td>\n","      <td>LTSummer22</td>\n","      <td>why cant my woke company give me a raise for i...</td>\n","      <td>neutral</td>\n","    </tr>\n","    <tr>\n","      <th>152079</th>\n","      <td>2022-11-10</td>\n","      <td>ajbell</td>\n","      <td>big day for us inflation figures whsmith rest...</td>\n","      <td>positive</td>\n","    </tr>\n","    <tr>\n","      <th>152078</th>\n","      <td>2022-11-10</td>\n","      <td>wheeliedealer</td>\n","      <td>stocks looking bit soggy but nothing dramatic ...</td>\n","      <td>negative</td>\n","    </tr>\n","    <tr>\n","      <th>152085</th>\n","      <td>2022-11-10</td>\n","      <td>alessiVT</td>\n","      <td>media reports many people are anxious about in...</td>\n","      <td>neutral</td>\n","    </tr>\n","    <tr>\n","      <th>30106</th>\n","      <td>2022-11-10</td>\n","      <td>no_in_red</td>\n","      <td>doug ford is stealing billions of dollars from...</td>\n","      <td>negative</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>356396 rows × 4 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-fc9b0f4d-a996-481a-b65c-f184e521c242')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-fc9b0f4d-a996-481a-b65c-f184e521c242 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-fc9b0f4d-a996-481a-b65c-f184e521c242');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":22}],"source":["tweet"]},{"cell_type":"code","source":["#tweet.drop(['Unnamed: 0'], axis = 1, inplace= True)"],"metadata":{"id":"bCppPZAEZwy6","executionInfo":{"status":"ok","timestamp":1684138443904,"user_tz":-540,"elapsed":9,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"execution_count":23,"outputs":[]},{"cell_type":"code","execution_count":24,"metadata":{"id":"t4VFuYBaaO9-","executionInfo":{"status":"ok","timestamp":1684138443904,"user_tz":-540,"elapsed":9,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["# Get the day of week column\n","tweet['weekday']= pd.to_datetime(tweet['Date']).dt.day_name(locale='en_US.utf8')"]},{"cell_type":"code","execution_count":26,"metadata":{"id":"X0OVs2QzaROJ","executionInfo":{"status":"ok","timestamp":1684138585321,"user_tz":-540,"elapsed":463,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["import datetime\n","DD = datetime.timedelta(days=1)\n","#filter for saturdays and Sunday date -1, -2 to become friday\n","#Saturdays\n","saturday = tweet['weekday'] == \"Saturday\"\n","tweet.loc[saturday,\"Date\"] = pd.to_datetime(tweet.loc[saturday,\"Date\"]).dt.date - DD"]},{"cell_type":"code","execution_count":27,"metadata":{"id":"y7oIt9FRaTZl","executionInfo":{"status":"ok","timestamp":1684138588841,"user_tz":-540,"elapsed":286,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["#Sundays\n","DD = datetime.timedelta(days=2)\n","\n","sunday = tweet['weekday'] == \"Sunday\"\n","tweet.loc[sunday,\"Date\"] = pd.to_datetime(tweet.loc[sunday,\"Date\"]).dt.date - DD"]},{"cell_type":"code","execution_count":28,"metadata":{"id":"Nu0WY5xVaXaZ","executionInfo":{"status":"ok","timestamp":1684138589290,"user_tz":-540,"elapsed":1,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["#rename Date column\n","tweet.rename(columns = {'Date':'DateRelease'}, inplace = True)"]},{"cell_type":"code","execution_count":29,"metadata":{"id":"e-DnNQJkhk-i","executionInfo":{"status":"ok","timestamp":1684138591285,"user_tz":-540,"elapsed":277,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["tweet.loc[tweet['sentiment'] == 'neutral', 'sentiment'] = 0\n","tweet.loc[tweet['sentiment'] == 'positive', 'sentiment'] = 1\n","tweet.loc[tweet['sentiment'] == 'negative', 'sentiment'] = -1"]},{"cell_type":"code","execution_count":30,"metadata":{"id":"Mcn-CKcnVi4y","executionInfo":{"status":"ok","timestamp":1684138593148,"user_tz":-540,"elapsed":4,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["tweet['sentiment'] = tweet['sentiment'].astype(float)"]},{"cell_type":"code","execution_count":31,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":295,"status":"ok","timestamp":1684138601325,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"},"user_tz":-540},"id":"TkAR8UYH7HDb","outputId":"806d8114-72f6-4b0d-ffd5-a0a09c8a6c83"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   DateRelease             User  \\\n","0   2013-12-16            Habus   \n","10  2013-12-16      Educ_Reform   \n","9   2013-12-16       TotesFacts   \n","8   2013-12-16          mrymler   \n","7   2013-12-16  KeithMcCullough   \n","\n","                                                 twee  sentiment weekday  \n","0   eu central bank warns against the bitcoin comp...        0.0  Monday  \n","10  is it a surprise that finance has not to date ...        0.0  Monday  \n","9   the cost of college textbooks in the us has ri...        0.0  Monday  \n","8   inb4 ala relax lah maryam the future will work...        0.0  Monday  \n","7   newsflash deflating the inflation in 2014 prov...        0.0  Monday  "],"text/html":["\n","  <div id=\"df-ccf81209-9045-47c9-b94e-1cb584f1bc75\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>DateRelease</th>\n","      <th>User</th>\n","      <th>twee</th>\n","      <th>sentiment</th>\n","      <th>weekday</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>2013-12-16</td>\n","      <td>Habus</td>\n","      <td>eu central bank warns against the bitcoin comp...</td>\n","      <td>0.0</td>\n","      <td>Monday</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>2013-12-16</td>\n","      <td>Educ_Reform</td>\n","      <td>is it a surprise that finance has not to date ...</td>\n","      <td>0.0</td>\n","      <td>Monday</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>2013-12-16</td>\n","      <td>TotesFacts</td>\n","      <td>the cost of college textbooks in the us has ri...</td>\n","      <td>0.0</td>\n","      <td>Monday</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>2013-12-16</td>\n","      <td>mrymler</td>\n","      <td>inb4 ala relax lah maryam the future will work...</td>\n","      <td>0.0</td>\n","      <td>Monday</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>2013-12-16</td>\n","      <td>KeithMcCullough</td>\n","      <td>newsflash deflating the inflation in 2014 prov...</td>\n","      <td>0.0</td>\n","      <td>Monday</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-ccf81209-9045-47c9-b94e-1cb584f1bc75')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-ccf81209-9045-47c9-b94e-1cb584f1bc75 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-ccf81209-9045-47c9-b94e-1cb584f1bc75');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":31}],"source":["tweet.head()"]},{"cell_type":"code","execution_count":32,"metadata":{"id":"yjZHNwFO7NVE","executionInfo":{"status":"ok","timestamp":1684138604463,"user_tz":-540,"elapsed":399,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["tweet.drop(['User','twee', 'weekday'], axis = 1, inplace= True)"]},{"cell_type":"code","execution_count":33,"metadata":{"id":"9IZFi0-7GWak","executionInfo":{"status":"ok","timestamp":1684138605994,"user_tz":-540,"elapsed":2,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["tweets= tweet.copy()"]},{"cell_type":"code","execution_count":34,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2,"status":"ok","timestamp":1684138606466,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"},"user_tz":-540},"id":"aQis1GB1Gex2","outputId":"e39d50aa-8375-41f9-be61-926cbf043212"},"outputs":[{"output_type":"stream","name":"stdout","text":["<class 'pandas.core.frame.DataFrame'>\n","Int64Index: 356396 entries, 0 to 30106\n","Data columns (total 2 columns):\n"," #   Column       Non-Null Count   Dtype  \n","---  ------       --------------   -----  \n"," 0   DateRelease  356396 non-null  object \n"," 1   sentiment    356396 non-null  float64\n","dtypes: float64(1), object(1)\n","memory usage: 8.2+ MB\n"]}],"source":["tweets.info()"]},{"cell_type":"code","source":["#Change the column to datetime type before groupby \n","tweets['DateRelease'] = pd.to_datetime(tweets['DateRelease'])"],"metadata":{"id":"msf8O9wvVVwi","executionInfo":{"status":"ok","timestamp":1684138609784,"user_tz":-540,"elapsed":426,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"execution_count":35,"outputs":[]},{"cell_type":"code","execution_count":36,"metadata":{"id":"jPnI0yi8VkF4","executionInfo":{"status":"ok","timestamp":1684138609784,"user_tz":-540,"elapsed":2,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["tweets= tweets.groupby('DateRelease').mean()"]},{"cell_type":"code","execution_count":37,"metadata":{"executionInfo":{"elapsed":3,"status":"ok","timestamp":1684138611669,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"},"user_tz":-540},"id":"C7I-6JurV7XO"},"outputs":[],"source":["tweets= tweets.reset_index(drop=False)"]},{"cell_type":"code","source":["tweets.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"xSglrFXjW-o3","executionInfo":{"status":"ok","timestamp":1684138617752,"user_tz":-540,"elapsed":274,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}},"outputId":"de564b0b-2782-42db-b840-7b2ef277535a"},"execution_count":38,"outputs":[{"output_type":"execute_result","data":{"text/plain":["  DateRelease  sentiment\n","0  2013-12-16  -0.014925\n","1  2013-12-17  -0.108911\n","2  2013-12-18  -0.006410\n","3  2013-12-19   0.068493\n","4  2013-12-20  -0.074380"],"text/html":["\n","  <div id=\"df-6a985742-c5d8-41b2-893f-64cc4d898eb8\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>DateRelease</th>\n","      <th>sentiment</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>2013-12-16</td>\n","      <td>-0.014925</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2013-12-17</td>\n","      <td>-0.108911</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2013-12-18</td>\n","      <td>-0.006410</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>2013-12-19</td>\n","      <td>0.068493</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>2013-12-20</td>\n","      <td>-0.074380</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-6a985742-c5d8-41b2-893f-64cc4d898eb8')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-6a985742-c5d8-41b2-893f-64cc4d898eb8 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-6a985742-c5d8-41b2-893f-64cc4d898eb8');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":38}]},{"cell_type":"markdown","metadata":{"id":"xNwhPj_pcxcD"},"source":["## Loading EURUSD price"]},{"cell_type":"code","execution_count":39,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":840,"status":"ok","timestamp":1684138624796,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"},"user_tz":-540},"id":"JgzNsLk-c5IH","outputId":"f58ca818-5052-46eb-b7b1-561be81933c6"},"outputs":[{"output_type":"stream","name":"stdout","text":["\r[*********************100%***********************]  1 of 1 completed\n"]}],"source":["price = yf.download(tickers ='EURUSD=X', start= '2013-12-16', end= '2022-11-11')"]},{"cell_type":"code","execution_count":40,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":0},"executionInfo":{"elapsed":7,"status":"ok","timestamp":1684138624796,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"},"user_tz":-540},"id":"3gefW-Chc6ea","outputId":"85da2529-c6ac-4b83-cd7d-0bd9eb8e8e3d"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                Open      High       Low     Close  Adj Close  Volume\n","Date                                                                 \n","2013-12-16  1.373815  1.379900  1.373815  1.373928   1.373928       0\n","2013-12-17  1.376178  1.378210  1.372701  1.376292   1.376292       0\n","2013-12-18  1.377107  1.378099  1.373479  1.377126   1.377126       0\n","2013-12-19  1.368307  1.369394  1.365113  1.368495   1.368495       0\n","2013-12-20  1.365598  1.370870  1.362583  1.365579   1.365579       0\n","...              ...       ...       ...       ...        ...     ...\n","2022-11-04  0.974963  0.993818  0.974849  0.974963   0.974963       0\n","2022-11-07  0.992881  1.000500  0.991945  0.992881   0.992881       0\n","2022-11-08  1.001863  1.009418  0.997606  1.001863   1.001863       0\n","2022-11-09  1.008085  1.008878  1.001252  1.008085   1.008085       0\n","2022-11-10  1.001954  1.018299  0.993779  1.001954   1.001954       0\n","\n","[2321 rows x 6 columns]"],"text/html":["\n","  <div id=\"df-a7bef8a4-918f-4dd6-900e-5b39978dbcc4\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Open</th>\n","      <th>High</th>\n","      <th>Low</th>\n","      <th>Close</th>\n","      <th>Adj Close</th>\n","      <th>Volume</th>\n","    </tr>\n","    <tr>\n","      <th>Date</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>2013-12-16</th>\n","      <td>1.373815</td>\n","      <td>1.379900</td>\n","      <td>1.373815</td>\n","      <td>1.373928</td>\n","      <td>1.373928</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2013-12-17</th>\n","      <td>1.376178</td>\n","      <td>1.378210</td>\n","      <td>1.372701</td>\n","      <td>1.376292</td>\n","      <td>1.376292</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2013-12-18</th>\n","      <td>1.377107</td>\n","      <td>1.378099</td>\n","      <td>1.373479</td>\n","      <td>1.377126</td>\n","      <td>1.377126</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2013-12-19</th>\n","      <td>1.368307</td>\n","      <td>1.369394</td>\n","      <td>1.365113</td>\n","      <td>1.368495</td>\n","      <td>1.368495</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2013-12-20</th>\n","      <td>1.365598</td>\n","      <td>1.370870</td>\n","      <td>1.362583</td>\n","      <td>1.365579</td>\n","      <td>1.365579</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-04</th>\n","      <td>0.974963</td>\n","      <td>0.993818</td>\n","      <td>0.974849</td>\n","      <td>0.974963</td>\n","      <td>0.974963</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-07</th>\n","      <td>0.992881</td>\n","      <td>1.000500</td>\n","      <td>0.991945</td>\n","      <td>0.992881</td>\n","      <td>0.992881</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-08</th>\n","      <td>1.001863</td>\n","      <td>1.009418</td>\n","      <td>0.997606</td>\n","      <td>1.001863</td>\n","      <td>1.001863</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-09</th>\n","      <td>1.008085</td>\n","      <td>1.008878</td>\n","      <td>1.001252</td>\n","      <td>1.008085</td>\n","      <td>1.008085</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-10</th>\n","      <td>1.001954</td>\n","      <td>1.018299</td>\n","      <td>0.993779</td>\n","      <td>1.001954</td>\n","      <td>1.001954</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>2321 rows × 6 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a7bef8a4-918f-4dd6-900e-5b39978dbcc4')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a7bef8a4-918f-4dd6-900e-5b39978dbcc4 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a7bef8a4-918f-4dd6-900e-5b39978dbcc4');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":40}],"source":["price"]},{"cell_type":"code","execution_count":41,"metadata":{"id":"o2VYPTSqc-hP","executionInfo":{"status":"ok","timestamp":1684138624797,"user_tz":-540,"elapsed":7,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["price.drop(['Volume'], inplace= True, axis = 1)"]},{"cell_type":"code","execution_count":42,"metadata":{"id":"eHsKctPwdARs","executionInfo":{"status":"ok","timestamp":1684138624797,"user_tz":-540,"elapsed":7,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["price = price.reset_index(drop=False)"]},{"cell_type":"code","execution_count":43,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":0},"executionInfo":{"elapsed":8,"status":"ok","timestamp":1684138624798,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"},"user_tz":-540},"id":"HPjtQd2VdBow","outputId":"fd477108-6b47-48ec-c87c-24206ac1705a"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["           Date      Open      High       Low     Close  Adj Close\n","0    2013-12-16  1.373815  1.379900  1.373815  1.373928   1.373928\n","1    2013-12-17  1.376178  1.378210  1.372701  1.376292   1.376292\n","2    2013-12-18  1.377107  1.378099  1.373479  1.377126   1.377126\n","3    2013-12-19  1.368307  1.369394  1.365113  1.368495   1.368495\n","4    2013-12-20  1.365598  1.370870  1.362583  1.365579   1.365579\n","...         ...       ...       ...       ...       ...        ...\n","2316 2022-11-04  0.974963  0.993818  0.974849  0.974963   0.974963\n","2317 2022-11-07  0.992881  1.000500  0.991945  0.992881   0.992881\n","2318 2022-11-08  1.001863  1.009418  0.997606  1.001863   1.001863\n","2319 2022-11-09  1.008085  1.008878  1.001252  1.008085   1.008085\n","2320 2022-11-10  1.001954  1.018299  0.993779  1.001954   1.001954\n","\n","[2321 rows x 6 columns]"],"text/html":["\n","  <div id=\"df-a7a80c06-b952-48e7-8114-0a991654e0b0\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Date</th>\n","      <th>Open</th>\n","      <th>High</th>\n","      <th>Low</th>\n","      <th>Close</th>\n","      <th>Adj Close</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>2013-12-16</td>\n","      <td>1.373815</td>\n","      <td>1.379900</td>\n","      <td>1.373815</td>\n","      <td>1.373928</td>\n","      <td>1.373928</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2013-12-17</td>\n","      <td>1.376178</td>\n","      <td>1.378210</td>\n","      <td>1.372701</td>\n","      <td>1.376292</td>\n","      <td>1.376292</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2013-12-18</td>\n","      <td>1.377107</td>\n","      <td>1.378099</td>\n","      <td>1.373479</td>\n","      <td>1.377126</td>\n","      <td>1.377126</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>2013-12-19</td>\n","      <td>1.368307</td>\n","      <td>1.369394</td>\n","      <td>1.365113</td>\n","      <td>1.368495</td>\n","      <td>1.368495</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>2013-12-20</td>\n","      <td>1.365598</td>\n","      <td>1.370870</td>\n","      <td>1.362583</td>\n","      <td>1.365579</td>\n","      <td>1.365579</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>2316</th>\n","      <td>2022-11-04</td>\n","      <td>0.974963</td>\n","      <td>0.993818</td>\n","      <td>0.974849</td>\n","      <td>0.974963</td>\n","      <td>0.974963</td>\n","    </tr>\n","    <tr>\n","      <th>2317</th>\n","      <td>2022-11-07</td>\n","      <td>0.992881</td>\n","      <td>1.000500</td>\n","      <td>0.991945</td>\n","      <td>0.992881</td>\n","      <td>0.992881</td>\n","    </tr>\n","    <tr>\n","      <th>2318</th>\n","      <td>2022-11-08</td>\n","      <td>1.001863</td>\n","      <td>1.009418</td>\n","      <td>0.997606</td>\n","      <td>1.001863</td>\n","      <td>1.001863</td>\n","    </tr>\n","    <tr>\n","      <th>2319</th>\n","      <td>2022-11-09</td>\n","      <td>1.008085</td>\n","      <td>1.008878</td>\n","      <td>1.001252</td>\n","      <td>1.008085</td>\n","      <td>1.008085</td>\n","    </tr>\n","    <tr>\n","      <th>2320</th>\n","      <td>2022-11-10</td>\n","      <td>1.001954</td>\n","      <td>1.018299</td>\n","      <td>0.993779</td>\n","      <td>1.001954</td>\n","      <td>1.001954</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>2321 rows × 6 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a7a80c06-b952-48e7-8114-0a991654e0b0')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a7a80c06-b952-48e7-8114-0a991654e0b0 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a7a80c06-b952-48e7-8114-0a991654e0b0');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":43}],"source":["price"]},{"cell_type":"markdown","metadata":{"id":"d6SRjRZ6dENa"},"source":["## Merging 2 dataset"]},{"cell_type":"code","execution_count":44,"metadata":{"id":"amA2iAXBdFru","executionInfo":{"status":"ok","timestamp":1684138640644,"user_tz":-540,"elapsed":1212,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["price['Date']= pd.to_datetime(price['Date']) \n","tweets['DateRelease']= pd.to_datetime(tweets['DateRelease']) "]},{"cell_type":"code","execution_count":45,"metadata":{"id":"KHYs5cj1dISe","executionInfo":{"status":"ok","timestamp":1684138641144,"user_tz":-540,"elapsed":13,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["df_final = pd.merge(price,tweets,how='left',left_on='Date',right_on='DateRelease')"]},{"cell_type":"code","source":["#df_final.drop(['index'], inplace= True, axis = 1)"],"metadata":{"id":"ktvDASBoYw6t","executionInfo":{"status":"ok","timestamp":1684138641145,"user_tz":-540,"elapsed":13,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"execution_count":46,"outputs":[]},{"cell_type":"code","execution_count":47,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":0},"executionInfo":{"elapsed":13,"status":"ok","timestamp":1684138641145,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"},"user_tz":-540},"id":"stMmeci4dKj3","outputId":"c7891757-767d-442e-c02d-0964be537f0e"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["           Date      Open      High       Low     Close  Adj Close  \\\n","0    2013-12-16  1.373815  1.379900  1.373815  1.373928   1.373928   \n","1    2013-12-17  1.376178  1.378210  1.372701  1.376292   1.376292   \n","2    2013-12-18  1.377107  1.378099  1.373479  1.377126   1.377126   \n","3    2013-12-19  1.368307  1.369394  1.365113  1.368495   1.368495   \n","4    2013-12-20  1.365598  1.370870  1.362583  1.365579   1.365579   \n","...         ...       ...       ...       ...       ...        ...   \n","2316 2022-11-04  0.974963  0.993818  0.974849  0.974963   0.974963   \n","2317 2022-11-07  0.992881  1.000500  0.991945  0.992881   0.992881   \n","2318 2022-11-08  1.001863  1.009418  0.997606  1.001863   1.001863   \n","2319 2022-11-09  1.008085  1.008878  1.001252  1.008085   1.008085   \n","2320 2022-11-10  1.001954  1.018299  0.993779  1.001954   1.001954   \n","\n","     DateRelease  sentiment  \n","0     2013-12-16  -0.014925  \n","1     2013-12-17  -0.108911  \n","2     2013-12-18  -0.006410  \n","3     2013-12-19   0.068493  \n","4     2013-12-20  -0.074380  \n","...          ...        ...  \n","2316  2022-11-04  -0.120438  \n","2317  2022-11-07  -0.213805  \n","2318  2022-11-08  -0.148820  \n","2319  2022-11-09  -0.138081  \n","2320  2022-11-10  -0.173095  \n","\n","[2321 rows x 8 columns]"],"text/html":["\n","  <div id=\"df-f7df3c66-b6d0-407a-bf5e-3af1b55ea06a\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Date</th>\n","      <th>Open</th>\n","      <th>High</th>\n","      <th>Low</th>\n","      <th>Close</th>\n","      <th>Adj Close</th>\n","      <th>DateRelease</th>\n","      <th>sentiment</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>2013-12-16</td>\n","      <td>1.373815</td>\n","      <td>1.379900</td>\n","      <td>1.373815</td>\n","      <td>1.373928</td>\n","      <td>1.373928</td>\n","      <td>2013-12-16</td>\n","      <td>-0.014925</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2013-12-17</td>\n","      <td>1.376178</td>\n","      <td>1.378210</td>\n","      <td>1.372701</td>\n","      <td>1.376292</td>\n","      <td>1.376292</td>\n","      <td>2013-12-17</td>\n","      <td>-0.108911</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2013-12-18</td>\n","      <td>1.377107</td>\n","      <td>1.378099</td>\n","      <td>1.373479</td>\n","      <td>1.377126</td>\n","      <td>1.377126</td>\n","      <td>2013-12-18</td>\n","      <td>-0.006410</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>2013-12-19</td>\n","      <td>1.368307</td>\n","      <td>1.369394</td>\n","      <td>1.365113</td>\n","      <td>1.368495</td>\n","      <td>1.368495</td>\n","      <td>2013-12-19</td>\n","      <td>0.068493</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>2013-12-20</td>\n","      <td>1.365598</td>\n","      <td>1.370870</td>\n","      <td>1.362583</td>\n","      <td>1.365579</td>\n","      <td>1.365579</td>\n","      <td>2013-12-20</td>\n","      <td>-0.074380</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>2316</th>\n","      <td>2022-11-04</td>\n","      <td>0.974963</td>\n","      <td>0.993818</td>\n","      <td>0.974849</td>\n","      <td>0.974963</td>\n","      <td>0.974963</td>\n","      <td>2022-11-04</td>\n","      <td>-0.120438</td>\n","    </tr>\n","    <tr>\n","      <th>2317</th>\n","      <td>2022-11-07</td>\n","      <td>0.992881</td>\n","      <td>1.000500</td>\n","      <td>0.991945</td>\n","      <td>0.992881</td>\n","      <td>0.992881</td>\n","      <td>2022-11-07</td>\n","      <td>-0.213805</td>\n","    </tr>\n","    <tr>\n","      <th>2318</th>\n","      <td>2022-11-08</td>\n","      <td>1.001863</td>\n","      <td>1.009418</td>\n","      <td>0.997606</td>\n","      <td>1.001863</td>\n","      <td>1.001863</td>\n","      <td>2022-11-08</td>\n","      <td>-0.148820</td>\n","    </tr>\n","    <tr>\n","      <th>2319</th>\n","      <td>2022-11-09</td>\n","      <td>1.008085</td>\n","      <td>1.008878</td>\n","      <td>1.001252</td>\n","      <td>1.008085</td>\n","      <td>1.008085</td>\n","      <td>2022-11-09</td>\n","      <td>-0.138081</td>\n","    </tr>\n","    <tr>\n","      <th>2320</th>\n","      <td>2022-11-10</td>\n","      <td>1.001954</td>\n","      <td>1.018299</td>\n","      <td>0.993779</td>\n","      <td>1.001954</td>\n","      <td>1.001954</td>\n","      <td>2022-11-10</td>\n","      <td>-0.173095</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>2321 rows × 8 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-f7df3c66-b6d0-407a-bf5e-3af1b55ea06a')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-f7df3c66-b6d0-407a-bf5e-3af1b55ea06a button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-f7df3c66-b6d0-407a-bf5e-3af1b55ea06a');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":47}],"source":["df_final"]},{"cell_type":"code","execution_count":48,"metadata":{"id":"WHCiLyItdMBq","executionInfo":{"status":"ok","timestamp":1684138641145,"user_tz":-540,"elapsed":12,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["# df_final.loc[df_final['sentiment'] == 'neutral', 'sentiment'] = 2\n","# df_final.loc[df_final['sentiment'] == 'positive', 'sentiment'] = 3\n","# df_final.loc[df_final['sentiment'] == 'negative', 'sentiment'] = 1"]},{"cell_type":"code","execution_count":49,"metadata":{"id":"G4C_qN6vdOHQ","executionInfo":{"status":"ok","timestamp":1684138641145,"user_tz":-540,"elapsed":11,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["# df_final.drop(['User','twee','weekday','Date'], axis = 1, inplace= True)"]},{"cell_type":"code","execution_count":50,"metadata":{"id":"y_guD35ldP-4","executionInfo":{"status":"ok","timestamp":1684138641146,"user_tz":-540,"elapsed":12,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["# df_final['sentiment'] = df_final['sentiment'].astype(float)"]},{"cell_type":"code","execution_count":51,"metadata":{"id":"vNNgye-5dRVt","executionInfo":{"status":"ok","timestamp":1684138641146,"user_tz":-540,"elapsed":12,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["# df_final=df_final.groupby('DateRelease').mean()"]},{"cell_type":"code","execution_count":52,"metadata":{"id":"FZjYPs8_jGBQ","executionInfo":{"status":"ok","timestamp":1684138641147,"user_tz":-540,"elapsed":13,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["df_final.drop(['DateRelease'], axis=1, inplace= True)"]},{"cell_type":"code","execution_count":53,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":0},"executionInfo":{"elapsed":12,"status":"ok","timestamp":1684138641147,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"},"user_tz":-540},"id":"kYDuoRs2dUg1","outputId":"2bddd259-0d65-4bd5-8824-c85068da4a42"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["           Date      Open      High       Low     Close  Adj Close  sentiment\n","0    2013-12-16  1.373815  1.379900  1.373815  1.373928   1.373928  -0.014925\n","1    2013-12-17  1.376178  1.378210  1.372701  1.376292   1.376292  -0.108911\n","2    2013-12-18  1.377107  1.378099  1.373479  1.377126   1.377126  -0.006410\n","3    2013-12-19  1.368307  1.369394  1.365113  1.368495   1.368495   0.068493\n","4    2013-12-20  1.365598  1.370870  1.362583  1.365579   1.365579  -0.074380\n","...         ...       ...       ...       ...       ...        ...        ...\n","2316 2022-11-04  0.974963  0.993818  0.974849  0.974963   0.974963  -0.120438\n","2317 2022-11-07  0.992881  1.000500  0.991945  0.992881   0.992881  -0.213805\n","2318 2022-11-08  1.001863  1.009418  0.997606  1.001863   1.001863  -0.148820\n","2319 2022-11-09  1.008085  1.008878  1.001252  1.008085   1.008085  -0.138081\n","2320 2022-11-10  1.001954  1.018299  0.993779  1.001954   1.001954  -0.173095\n","\n","[2321 rows x 7 columns]"],"text/html":["\n","  <div id=\"df-92c2baa5-2b1e-4f94-8934-fef1954c53bb\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Date</th>\n","      <th>Open</th>\n","      <th>High</th>\n","      <th>Low</th>\n","      <th>Close</th>\n","      <th>Adj Close</th>\n","      <th>sentiment</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>2013-12-16</td>\n","      <td>1.373815</td>\n","      <td>1.379900</td>\n","      <td>1.373815</td>\n","      <td>1.373928</td>\n","      <td>1.373928</td>\n","      <td>-0.014925</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2013-12-17</td>\n","      <td>1.376178</td>\n","      <td>1.378210</td>\n","      <td>1.372701</td>\n","      <td>1.376292</td>\n","      <td>1.376292</td>\n","      <td>-0.108911</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2013-12-18</td>\n","      <td>1.377107</td>\n","      <td>1.378099</td>\n","      <td>1.373479</td>\n","      <td>1.377126</td>\n","      <td>1.377126</td>\n","      <td>-0.006410</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>2013-12-19</td>\n","      <td>1.368307</td>\n","      <td>1.369394</td>\n","      <td>1.365113</td>\n","      <td>1.368495</td>\n","      <td>1.368495</td>\n","      <td>0.068493</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>2013-12-20</td>\n","      <td>1.365598</td>\n","      <td>1.370870</td>\n","      <td>1.362583</td>\n","      <td>1.365579</td>\n","      <td>1.365579</td>\n","      <td>-0.074380</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>2316</th>\n","      <td>2022-11-04</td>\n","      <td>0.974963</td>\n","      <td>0.993818</td>\n","      <td>0.974849</td>\n","      <td>0.974963</td>\n","      <td>0.974963</td>\n","      <td>-0.120438</td>\n","    </tr>\n","    <tr>\n","      <th>2317</th>\n","      <td>2022-11-07</td>\n","      <td>0.992881</td>\n","      <td>1.000500</td>\n","      <td>0.991945</td>\n","      <td>0.992881</td>\n","      <td>0.992881</td>\n","      <td>-0.213805</td>\n","    </tr>\n","    <tr>\n","      <th>2318</th>\n","      <td>2022-11-08</td>\n","      <td>1.001863</td>\n","      <td>1.009418</td>\n","      <td>0.997606</td>\n","      <td>1.001863</td>\n","      <td>1.001863</td>\n","      <td>-0.148820</td>\n","    </tr>\n","    <tr>\n","      <th>2319</th>\n","      <td>2022-11-09</td>\n","      <td>1.008085</td>\n","      <td>1.008878</td>\n","      <td>1.001252</td>\n","      <td>1.008085</td>\n","      <td>1.008085</td>\n","      <td>-0.138081</td>\n","    </tr>\n","    <tr>\n","      <th>2320</th>\n","      <td>2022-11-10</td>\n","      <td>1.001954</td>\n","      <td>1.018299</td>\n","      <td>0.993779</td>\n","      <td>1.001954</td>\n","      <td>1.001954</td>\n","      <td>-0.173095</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>2321 rows × 7 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-92c2baa5-2b1e-4f94-8934-fef1954c53bb')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-92c2baa5-2b1e-4f94-8934-fef1954c53bb button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-92c2baa5-2b1e-4f94-8934-fef1954c53bb');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":53}],"source":["df_final"]},{"cell_type":"code","execution_count":54,"metadata":{"id":"pc85Ck9DdWQ4","executionInfo":{"status":"ok","timestamp":1684138641147,"user_tz":-540,"elapsed":12,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["df_final['returns'] = (df_final['Adj Close']/df_final['Adj Close'].shift(1)) -1\n","df_final['returnsclass'] = [1 if df_final.returns[i]>0 else 0 for i in range(len(df_final))]"]},{"cell_type":"code","execution_count":55,"metadata":{"id":"VSF5mMBrdbRt","executionInfo":{"status":"ok","timestamp":1684138641148,"user_tz":-540,"elapsed":13,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["df_final.drop(['returns'], axis=1, inplace= True)"]},{"cell_type":"code","execution_count":56,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":0},"executionInfo":{"elapsed":12,"status":"ok","timestamp":1684138641148,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"},"user_tz":-540},"id":"3WPeVsUIfazX","outputId":"bca4d5a9-08c0-421c-a83b-df18128f0c58"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                Open      High       Low     Close  Adj Close  sentiment  \\\n","Date                                                                       \n","2013-12-16  1.373815  1.379900  1.373815  1.373928   1.373928  -0.014925   \n","2013-12-17  1.376178  1.378210  1.372701  1.376292   1.376292  -0.108911   \n","2013-12-18  1.377107  1.378099  1.373479  1.377126   1.377126  -0.006410   \n","2013-12-19  1.368307  1.369394  1.365113  1.368495   1.368495   0.068493   \n","2013-12-20  1.365598  1.370870  1.362583  1.365579   1.365579  -0.074380   \n","...              ...       ...       ...       ...        ...        ...   \n","2022-11-04  0.974963  0.993818  0.974849  0.974963   0.974963  -0.120438   \n","2022-11-07  0.992881  1.000500  0.991945  0.992881   0.992881  -0.213805   \n","2022-11-08  1.001863  1.009418  0.997606  1.001863   1.001863  -0.148820   \n","2022-11-09  1.008085  1.008878  1.001252  1.008085   1.008085  -0.138081   \n","2022-11-10  1.001954  1.018299  0.993779  1.001954   1.001954  -0.173095   \n","\n","            returnsclass  \n","Date                      \n","2013-12-16             0  \n","2013-12-17             1  \n","2013-12-18             1  \n","2013-12-19             0  \n","2013-12-20             0  \n","...                  ...  \n","2022-11-04             0  \n","2022-11-07             1  \n","2022-11-08             1  \n","2022-11-09             1  \n","2022-11-10             0  \n","\n","[2321 rows x 7 columns]"],"text/html":["\n","  <div id=\"df-93ec979d-feae-42eb-97b7-ee72da723a3b\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Open</th>\n","      <th>High</th>\n","      <th>Low</th>\n","      <th>Close</th>\n","      <th>Adj Close</th>\n","      <th>sentiment</th>\n","      <th>returnsclass</th>\n","    </tr>\n","    <tr>\n","      <th>Date</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>2013-12-16</th>\n","      <td>1.373815</td>\n","      <td>1.379900</td>\n","      <td>1.373815</td>\n","      <td>1.373928</td>\n","      <td>1.373928</td>\n","      <td>-0.014925</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2013-12-17</th>\n","      <td>1.376178</td>\n","      <td>1.378210</td>\n","      <td>1.372701</td>\n","      <td>1.376292</td>\n","      <td>1.376292</td>\n","      <td>-0.108911</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2013-12-18</th>\n","      <td>1.377107</td>\n","      <td>1.378099</td>\n","      <td>1.373479</td>\n","      <td>1.377126</td>\n","      <td>1.377126</td>\n","      <td>-0.006410</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2013-12-19</th>\n","      <td>1.368307</td>\n","      <td>1.369394</td>\n","      <td>1.365113</td>\n","      <td>1.368495</td>\n","      <td>1.368495</td>\n","      <td>0.068493</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2013-12-20</th>\n","      <td>1.365598</td>\n","      <td>1.370870</td>\n","      <td>1.362583</td>\n","      <td>1.365579</td>\n","      <td>1.365579</td>\n","      <td>-0.074380</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-04</th>\n","      <td>0.974963</td>\n","      <td>0.993818</td>\n","      <td>0.974849</td>\n","      <td>0.974963</td>\n","      <td>0.974963</td>\n","      <td>-0.120438</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-07</th>\n","      <td>0.992881</td>\n","      <td>1.000500</td>\n","      <td>0.991945</td>\n","      <td>0.992881</td>\n","      <td>0.992881</td>\n","      <td>-0.213805</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-08</th>\n","      <td>1.001863</td>\n","      <td>1.009418</td>\n","      <td>0.997606</td>\n","      <td>1.001863</td>\n","      <td>1.001863</td>\n","      <td>-0.148820</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-09</th>\n","      <td>1.008085</td>\n","      <td>1.008878</td>\n","      <td>1.001252</td>\n","      <td>1.008085</td>\n","      <td>1.008085</td>\n","      <td>-0.138081</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-10</th>\n","      <td>1.001954</td>\n","      <td>1.018299</td>\n","      <td>0.993779</td>\n","      <td>1.001954</td>\n","      <td>1.001954</td>\n","      <td>-0.173095</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>2321 rows × 7 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-93ec979d-feae-42eb-97b7-ee72da723a3b')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-93ec979d-feae-42eb-97b7-ee72da723a3b button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-93ec979d-feae-42eb-97b7-ee72da723a3b');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":56}],"source":["df_final = df_final.set_index(['Date'])\n","df_final"]},{"cell_type":"markdown","source":["## **SUPPORT VECTOR MACHINE**"],"metadata":{"id":"WR59PkXWVCCU"}},{"cell_type":"code","source":["# Separate the features (historical prices and technical indicators) and the target (movement)\n","features_SA = df_final.iloc[:, :-1]\n","target_SA = df_final['returnsclass'].values"],"metadata":{"id":"8tnc0NzsVIyS","executionInfo":{"status":"ok","timestamp":1684138645368,"user_tz":-540,"elapsed":310,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"execution_count":57,"outputs":[]},{"cell_type":"code","source":["# Scale the features\n","scaler = MinMaxScaler()\n","scaled_features_SA = scaler.fit_transform(features_SA)"],"metadata":{"id":"XTmhk-maVPl3","executionInfo":{"status":"ok","timestamp":1684138645369,"user_tz":-540,"elapsed":10,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"execution_count":58,"outputs":[]},{"cell_type":"code","source":["# Split the data into training and test sets\n","X_SA_train, X_SA_test, y_SA_train, y_SA_test = train_test_split(scaled_features_SA, target_SA, test_size=0.2, random_state=42)"],"metadata":{"id":"kqlmLR3yVTLS","executionInfo":{"status":"ok","timestamp":1684138645369,"user_tz":-540,"elapsed":9,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"execution_count":59,"outputs":[]},{"cell_type":"code","source":["# Create and train the SVM model\n","model_SA = SVC(kernel='rbf')\n","model_SA.fit(X_SA_train, y_SA_train)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":75},"id":"tJh9G2B7VVMK","executionInfo":{"status":"ok","timestamp":1684138645369,"user_tz":-540,"elapsed":9,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}},"outputId":"7678ed67-7cab-482d-87dd-d5f9b83dd610"},"execution_count":60,"outputs":[{"output_type":"execute_result","data":{"text/plain":["SVC()"],"text/html":["<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>SVC()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" checked><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">SVC</label><div class=\"sk-toggleable__content\"><pre>SVC()</pre></div></div></div></div></div>"]},"metadata":{},"execution_count":60}]},{"cell_type":"code","source":["# Make predictions on the test set\n","y_pred_SA = model_SA.predict(X_SA_test)"],"metadata":{"id":"pa0qsBOsVYbb","executionInfo":{"status":"ok","timestamp":1684138645370,"user_tz":-540,"elapsed":9,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"execution_count":61,"outputs":[]},{"cell_type":"code","source":["# Calculate the accuracy of the model\n","accuracy_SA = accuracy_score(y_SA_test, y_pred_SA)\n","print(f'Test Accuracy: {accuracy_SA}')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"KUZkVbm9Vb9N","executionInfo":{"status":"ok","timestamp":1684138645794,"user_tz":-540,"elapsed":433,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}},"outputId":"36fb7e6e-16db-4cd4-ac55-8c8f1cd84e72"},"execution_count":62,"outputs":[{"output_type":"stream","name":"stdout","text":["Test Accuracy: 0.5161290322580645\n"]}]},{"cell_type":"code","source":["# Calculate the classification report\n","report_SA = classification_report(y_SA_test, y_pred_SA, digits = 4)\n","print(\"Classification Report:\")\n","print(report_SA)\n","\n","# Calculate the confusion matrix\n","matrix_SA = confusion_matrix(y_SA_test, y_pred_SA)\n","print(\"Confusion Matrix:\")\n","print(matrix_SA)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"-R9RPCQDVcfP","executionInfo":{"status":"ok","timestamp":1684138645794,"user_tz":-540,"elapsed":6,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}},"outputId":"3a0000c6-c781-4df6-989f-b23d67340326"},"execution_count":63,"outputs":[{"output_type":"stream","name":"stdout","text":["Classification Report:\n","              precision    recall  f1-score   support\n","\n","           0     0.5037    0.8904    0.6434       228\n","           1     0.5968    0.1561    0.2475       237\n","\n","    accuracy                         0.5161       465\n","   macro avg     0.5502    0.5232    0.4455       465\n","weighted avg     0.5511    0.5161    0.4416       465\n","\n","Confusion Matrix:\n","[[203  25]\n"," [200  37]]\n"]}]},{"cell_type":"code","source":["# Prepare the input data for prediction (assuming X_test represents the most recent data available)\n","input_data_SA = scaled_features_SA[-1]  # Select the most recent data point as input data\n","\n","# Make the prediction\n","prediction_SA = model_SA.predict([input_data_SA])\n","\n","# Interpret the prediction\n","if prediction_SA == 1:\n","    price_movement = \"Positive\"\n","else:\n","    price_movement = \"Negative\"\n","\n","# Print the predicted price movement\n","print(\"Next day's price movement SA:\", price_movement)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"N0oVjLqEVgag","executionInfo":{"status":"ok","timestamp":1684138645794,"user_tz":-540,"elapsed":4,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}},"outputId":"5b3224ff-03be-4d45-918d-3a9a80835a19"},"execution_count":64,"outputs":[{"output_type":"stream","name":"stdout","text":["Next day's price movement SA: Negative\n"]}]},{"cell_type":"markdown","source":["## OTHER METHODS"],"metadata":{"id":"wfnuvqrxVkHZ"}},{"cell_type":"code","source":["X1= df_final.iloc[:,0:6]"],"metadata":{"id":"HdLjcmJaozxn"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["Y1 = df_final['returnsclass']"],"metadata":{"id":"idHfFYX_o_g-"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from sklearn.preprocessing import StandardScaler\n","standardizer = StandardScaler()\n","X1 = standardizer.fit_transform(X1)"],"metadata":{"id":"L9yM1C8SpRxR"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from sklearn.model_selection import train_test_split\n","\n","X1_train, X1_test, Y1_train, Y1_test = train_test_split(X1, Y1, test_size = 0.15, shuffle = False)"],"metadata":{"id":"r_6bUFkOpStL"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["#Importing each model\n","\n","modelsSA = {}\n","\n","# Logistic Regression\n","from sklearn.linear_model import LogisticRegression\n","modelsSA['Logistic Regression'] = LogisticRegression()\n","\n","# Support Vector Machines\n","from sklearn.svm import LinearSVC\n","modelsSA['Support Vector Machines'] = LinearSVC()\n","\n","# Decision Trees\n","from sklearn.tree import DecisionTreeClassifier\n","modelsSA['Decision Trees'] = DecisionTreeClassifier()\n","\n","# Random Forest\n","from sklearn.ensemble import RandomForestClassifier\n","modelsSA['Random Forest'] = RandomForestClassifier()\n","\n","# Naive Bayes\n","from sklearn.naive_bayes import GaussianNB\n","modelsSA['Naive Bayes'] = GaussianNB()\n","\n","# K-Nearest Neighbors\n","from sklearn.neighbors import KNeighborsClassifier\n","modelsSA['K-Nearest Neighbor'] = KNeighborsClassifier()"],"metadata":{"id":"Ors17lR7prfO"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["#Calculating their accuracy, precision, and recall\n","from sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score\n","\n","accuracy, precision, recall, f1 = {}, {}, {}, {}\n","\n","for key in modelsSA.keys():\n","    \n","    # Fit the classifier model\n","    modelsSA[key].fit(X1_train, Y1_train)\n","    \n","    # Prediction \n","    predictionsSA = modelsSA[key].predict(X1_test)\n","    \n","    # Calculate Accuracy, Precision and Recall Metrics\n","    accuracy[key] = accuracy_score(predictionsSA, Y1_test)\n","    precision[key] = precision_score(predictionsSA, Y1_test)\n","    recall[key] = recall_score(predictionsSA, Y1_test)\n","    f1[key]= f1_score(predictionsSA, Y1_test)"],"metadata":{"id":"s-JjkVhbpy-u"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["#Printing assessments of each model\n","df_modelSA = pd.DataFrame(index = modelsSA.keys(), columns = ['Accuracy', 'Precision', 'Recall', 'f1'])\n","df_modelSA['Accuracy'] = accuracy.values()\n","df_modelSA['Precision'] = precision.values()\n","df_modelSA['Recall'] = recall.values()\n","df_modelSA['f1'] = f1.values()\n","df_modelSA"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"zAIYn7-zwEKD","executionInfo":{"status":"ok","timestamp":1683634030765,"user_tz":-540,"elapsed":13,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}},"outputId":"4c2e4e0f-bfaa-4497-e29a-cea60e0a656c"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                         Accuracy  Precision    Recall        f1\n","Logistic Regression      0.541547   0.055215  0.600000  0.101124\n","Support Vector Machines  0.547278   0.116564  0.575758  0.193878\n","Decision Trees           0.498567   0.349693  0.452381  0.394464\n","Random Forest            0.504298   0.288344  0.451923  0.352060\n","Naive Bayes              0.515759   0.208589  0.459459  0.286920\n","K-Nearest Neighbor       0.504298   0.386503  0.463235  0.421405"],"text/html":["\n","  <div id=\"df-51789901-b404-4764-90ca-8c77899e987d\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Accuracy</th>\n","      <th>Precision</th>\n","      <th>Recall</th>\n","      <th>f1</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>Logistic Regression</th>\n","      <td>0.541547</td>\n","      <td>0.055215</td>\n","      <td>0.600000</td>\n","      <td>0.101124</td>\n","    </tr>\n","    <tr>\n","      <th>Support Vector Machines</th>\n","      <td>0.547278</td>\n","      <td>0.116564</td>\n","      <td>0.575758</td>\n","      <td>0.193878</td>\n","    </tr>\n","    <tr>\n","      <th>Decision Trees</th>\n","      <td>0.498567</td>\n","      <td>0.349693</td>\n","      <td>0.452381</td>\n","      <td>0.394464</td>\n","    </tr>\n","    <tr>\n","      <th>Random Forest</th>\n","      <td>0.504298</td>\n","      <td>0.288344</td>\n","      <td>0.451923</td>\n","      <td>0.352060</td>\n","    </tr>\n","    <tr>\n","      <th>Naive Bayes</th>\n","      <td>0.515759</td>\n","      <td>0.208589</td>\n","      <td>0.459459</td>\n","      <td>0.286920</td>\n","    </tr>\n","    <tr>\n","      <th>K-Nearest Neighbor</th>\n","      <td>0.504298</td>\n","      <td>0.386503</td>\n","      <td>0.463235</td>\n","      <td>0.421405</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-51789901-b404-4764-90ca-8c77899e987d')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-51789901-b404-4764-90ca-8c77899e987d button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-51789901-b404-4764-90ca-8c77899e987d');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":51}]},{"cell_type":"markdown","metadata":{"id":"Ckf2I8RQ6tQB"},"source":["# **SA/TA for SVM**"]},{"cell_type":"markdown","source":["## DATA LOADING"],"metadata":{"id":"VM6wNr00bWTI"}},{"cell_type":"code","execution_count":65,"metadata":{"id":"xHzz6lGs644O","colab":{"base_uri":"https://localhost:8080/","height":0},"executionInfo":{"status":"ok","timestamp":1684138665946,"user_tz":-540,"elapsed":281,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}},"outputId":"2a0c36b3-862d-429a-d5d6-8d319a349634"},"outputs":[{"output_type":"stream","name":"stdout","text":["\r[*********************100%***********************]  1 of 1 completed\n"]},{"output_type":"execute_result","data":{"text/plain":["                Open      High       Low     Close  Adj Close  Volume\n","Date                                                                 \n","2022-11-04  0.974963  0.993818  0.974849  0.974963   0.974963       0\n","2022-11-07  0.992881  1.000500  0.991945  0.992881   0.992881       0\n","2022-11-08  1.001863  1.009418  0.997606  1.001863   1.001863       0\n","2022-11-09  1.008085  1.008878  1.001252  1.008085   1.008085       0\n","2022-11-10  1.001954  1.018299  0.993779  1.001954   1.001954       0"],"text/html":["\n","  <div id=\"df-0b50b144-de1c-495f-895c-15adfc73f125\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Open</th>\n","      <th>High</th>\n","      <th>Low</th>\n","      <th>Close</th>\n","      <th>Adj Close</th>\n","      <th>Volume</th>\n","    </tr>\n","    <tr>\n","      <th>Date</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>2022-11-04</th>\n","      <td>0.974963</td>\n","      <td>0.993818</td>\n","      <td>0.974849</td>\n","      <td>0.974963</td>\n","      <td>0.974963</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-07</th>\n","      <td>0.992881</td>\n","      <td>1.000500</td>\n","      <td>0.991945</td>\n","      <td>0.992881</td>\n","      <td>0.992881</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-08</th>\n","      <td>1.001863</td>\n","      <td>1.009418</td>\n","      <td>0.997606</td>\n","      <td>1.001863</td>\n","      <td>1.001863</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-09</th>\n","      <td>1.008085</td>\n","      <td>1.008878</td>\n","      <td>1.001252</td>\n","      <td>1.008085</td>\n","      <td>1.008085</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-10</th>\n","      <td>1.001954</td>\n","      <td>1.018299</td>\n","      <td>0.993779</td>\n","      <td>1.001954</td>\n","      <td>1.001954</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-0b50b144-de1c-495f-895c-15adfc73f125')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-0b50b144-de1c-495f-895c-15adfc73f125 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-0b50b144-de1c-495f-895c-15adfc73f125');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":65}],"source":["data = yf.download(tickers ='EURUSD=X', end= '2022-11-11')\n","data.tail()"]},{"cell_type":"code","execution_count":66,"metadata":{"id":"se-nyBWD6-2f","executionInfo":{"status":"ok","timestamp":1684138666564,"user_tz":-540,"elapsed":13,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["# Adding indicators\n","data['RSI']=ta.rsi(data.Close, length=15)\n","data['SMA']= ta.sma(data.Close, length=10)\n","data['EMA']= ta.ema(data.Close, length= 10)\n","data['EMAF']=ta.ema(data.Close, length=20)\n","data['EMAM']=ta.ema(data.Close, length=100)\n","data['EMAS']=ta.ema(data.Close, length=150)\n","macd = data.ta.macd(fast =12, slow =26, signal =9)\n","BB = data.ta.bbands(length=12, std =2)\n","ADX = data.ta.adx(length = 20)\n","ROC = data.ta.roc(length = 12)\n","\n","dataTA = pd.concat([data, macd, BB, ADX, ROC], axis = 1)"]},{"cell_type":"code","source":["dataTA"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":0},"id":"5XVclNcPxGJh","executionInfo":{"status":"ok","timestamp":1684138666565,"user_tz":-540,"elapsed":13,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}},"outputId":"6db0df90-76bf-449c-9c4f-e9ba19a1ba7f"},"execution_count":67,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                Open      High       Low     Close  Adj Close  Volume  \\\n","Date                                                                    \n","2003-12-01  1.203398  1.204007  1.194401  1.196501   1.196501       0   \n","2003-12-02  1.196101  1.210903  1.194600  1.208897   1.208897       0   \n","2003-12-03  1.209000  1.213003  1.207700  1.212298   1.212298       0   \n","2003-12-04  1.212004  1.214403  1.204398  1.208094   1.208094       0   \n","2003-12-05  1.207802  1.219096  1.206593  1.218695   1.218695       0   \n","...              ...       ...       ...       ...        ...     ...   \n","2022-11-04  0.974963  0.993818  0.974849  0.974963   0.974963       0   \n","2022-11-07  0.992881  1.000500  0.991945  0.992881   0.992881       0   \n","2022-11-08  1.001863  1.009418  0.997606  1.001863   1.001863       0   \n","2022-11-09  1.008085  1.008878  1.001252  1.008085   1.008085       0   \n","2022-11-10  1.001954  1.018299  0.993779  1.001954   1.001954       0   \n","\n","                  RSI       SMA       EMA      EMAF  ...  MACDs_12_26_9  \\\n","Date                                                 ...                  \n","2003-12-01        NaN       NaN       NaN       NaN  ...            NaN   \n","2003-12-02        NaN       NaN       NaN       NaN  ...            NaN   \n","2003-12-03        NaN       NaN       NaN       NaN  ...            NaN   \n","2003-12-04        NaN       NaN       NaN       NaN  ...            NaN   \n","2003-12-05        NaN       NaN       NaN       NaN  ...            NaN   \n","...               ...       ...       ...       ...  ...            ...   \n","2022-11-04  43.011123  0.990533  0.986115  0.985942  ...       0.000301   \n","2022-11-07  53.118878  0.991220  0.987345  0.986603  ...       0.000335   \n","2022-11-08  57.196524  0.992542  0.989985  0.988056  ...       0.000588   \n","2022-11-09  59.791762  0.993713  0.993276  0.989964  ...       0.001065   \n","2022-11-10  56.194274  0.992989  0.994854  0.991106  ...       0.001555   \n","\n","            BBL_12_2.0  BBM_12_2.0  BBU_12_2.0  BBB_12_2.0  BBP_12_2.0  \\\n","Date                                                                     \n","2003-12-01         NaN         NaN         NaN         NaN         NaN   \n","2003-12-02         NaN         NaN         NaN         NaN         NaN   \n","2003-12-03         NaN         NaN         NaN         NaN         NaN   \n","2003-12-04         NaN         NaN         NaN         NaN         NaN   \n","2003-12-05         NaN         NaN         NaN         NaN         NaN   \n","...                ...         ...         ...         ...         ...   \n","2022-11-04    0.969172    0.988323    1.007473    3.875445    0.151205   \n","2022-11-07    0.971761    0.989675    1.007590    3.620319    0.589474   \n","2022-11-08    0.974118    0.991673    1.009228    3.540559    0.790236   \n","2022-11-09    0.974180    0.993513    1.012845    3.891718    0.876882   \n","2022-11-10    0.975008    0.994621    1.014235    3.943934    0.686923   \n","\n","               ADX_20     DMP_20     DMN_20    ROC_12  \n","Date                                                   \n","2003-12-01        NaN        NaN        NaN       NaN  \n","2003-12-02        NaN        NaN        NaN       NaN  \n","2003-12-03        NaN        NaN        NaN       NaN  \n","2003-12-04        NaN        NaN        NaN       NaN  \n","2003-12-05        NaN        NaN        NaN       NaN  \n","...               ...        ...        ...       ...  \n","2022-11-04  10.588025  18.945042  19.588859 -1.158250  \n","2022-11-07  10.311693  19.627748  17.736596  1.662092  \n","2022-11-08  10.453165  21.704507  16.662629  2.451556  \n","2022-11-09  10.587564  21.084724  16.186820  2.238945  \n","2022-11-10  11.108691  22.612443  14.760371  1.345624  \n","\n","[4915 rows x 24 columns]"],"text/html":["\n","  <div id=\"df-dae6d91f-ee67-4ea9-a69f-449a2c11c4fa\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Open</th>\n","      <th>High</th>\n","      <th>Low</th>\n","      <th>Close</th>\n","      <th>Adj Close</th>\n","      <th>Volume</th>\n","      <th>RSI</th>\n","      <th>SMA</th>\n","      <th>EMA</th>\n","      <th>EMAF</th>\n","      <th>...</th>\n","      <th>MACDs_12_26_9</th>\n","      <th>BBL_12_2.0</th>\n","      <th>BBM_12_2.0</th>\n","      <th>BBU_12_2.0</th>\n","      <th>BBB_12_2.0</th>\n","      <th>BBP_12_2.0</th>\n","      <th>ADX_20</th>\n","      <th>DMP_20</th>\n","      <th>DMN_20</th>\n","      <th>ROC_12</th>\n","    </tr>\n","    <tr>\n","      <th>Date</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>2003-12-01</th>\n","      <td>1.203398</td>\n","      <td>1.204007</td>\n","      <td>1.194401</td>\n","      <td>1.196501</td>\n","      <td>1.196501</td>\n","      <td>0</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>...</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>2003-12-02</th>\n","      <td>1.196101</td>\n","      <td>1.210903</td>\n","      <td>1.194600</td>\n","      <td>1.208897</td>\n","      <td>1.208897</td>\n","      <td>0</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>...</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>2003-12-03</th>\n","      <td>1.209000</td>\n","      <td>1.213003</td>\n","      <td>1.207700</td>\n","      <td>1.212298</td>\n","      <td>1.212298</td>\n","      <td>0</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>...</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>2003-12-04</th>\n","      <td>1.212004</td>\n","      <td>1.214403</td>\n","      <td>1.204398</td>\n","      <td>1.208094</td>\n","      <td>1.208094</td>\n","      <td>0</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>...</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>2003-12-05</th>\n","      <td>1.207802</td>\n","      <td>1.219096</td>\n","      <td>1.206593</td>\n","      <td>1.218695</td>\n","      <td>1.218695</td>\n","      <td>0</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>...</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-04</th>\n","      <td>0.974963</td>\n","      <td>0.993818</td>\n","      <td>0.974849</td>\n","      <td>0.974963</td>\n","      <td>0.974963</td>\n","      <td>0</td>\n","      <td>43.011123</td>\n","      <td>0.990533</td>\n","      <td>0.986115</td>\n","      <td>0.985942</td>\n","      <td>...</td>\n","      <td>0.000301</td>\n","      <td>0.969172</td>\n","      <td>0.988323</td>\n","      <td>1.007473</td>\n","      <td>3.875445</td>\n","      <td>0.151205</td>\n","      <td>10.588025</td>\n","      <td>18.945042</td>\n","      <td>19.588859</td>\n","      <td>-1.158250</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-07</th>\n","      <td>0.992881</td>\n","      <td>1.000500</td>\n","      <td>0.991945</td>\n","      <td>0.992881</td>\n","      <td>0.992881</td>\n","      <td>0</td>\n","      <td>53.118878</td>\n","      <td>0.991220</td>\n","      <td>0.987345</td>\n","      <td>0.986603</td>\n","      <td>...</td>\n","      <td>0.000335</td>\n","      <td>0.971761</td>\n","      <td>0.989675</td>\n","      <td>1.007590</td>\n","      <td>3.620319</td>\n","      <td>0.589474</td>\n","      <td>10.311693</td>\n","      <td>19.627748</td>\n","      <td>17.736596</td>\n","      <td>1.662092</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-08</th>\n","      <td>1.001863</td>\n","      <td>1.009418</td>\n","      <td>0.997606</td>\n","      <td>1.001863</td>\n","      <td>1.001863</td>\n","      <td>0</td>\n","      <td>57.196524</td>\n","      <td>0.992542</td>\n","      <td>0.989985</td>\n","      <td>0.988056</td>\n","      <td>...</td>\n","      <td>0.000588</td>\n","      <td>0.974118</td>\n","      <td>0.991673</td>\n","      <td>1.009228</td>\n","      <td>3.540559</td>\n","      <td>0.790236</td>\n","      <td>10.453165</td>\n","      <td>21.704507</td>\n","      <td>16.662629</td>\n","      <td>2.451556</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-09</th>\n","      <td>1.008085</td>\n","      <td>1.008878</td>\n","      <td>1.001252</td>\n","      <td>1.008085</td>\n","      <td>1.008085</td>\n","      <td>0</td>\n","      <td>59.791762</td>\n","      <td>0.993713</td>\n","      <td>0.993276</td>\n","      <td>0.989964</td>\n","      <td>...</td>\n","      <td>0.001065</td>\n","      <td>0.974180</td>\n","      <td>0.993513</td>\n","      <td>1.012845</td>\n","      <td>3.891718</td>\n","      <td>0.876882</td>\n","      <td>10.587564</td>\n","      <td>21.084724</td>\n","      <td>16.186820</td>\n","      <td>2.238945</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-10</th>\n","      <td>1.001954</td>\n","      <td>1.018299</td>\n","      <td>0.993779</td>\n","      <td>1.001954</td>\n","      <td>1.001954</td>\n","      <td>0</td>\n","      <td>56.194274</td>\n","      <td>0.992989</td>\n","      <td>0.994854</td>\n","      <td>0.991106</td>\n","      <td>...</td>\n","      <td>0.001555</td>\n","      <td>0.975008</td>\n","      <td>0.994621</td>\n","      <td>1.014235</td>\n","      <td>3.943934</td>\n","      <td>0.686923</td>\n","      <td>11.108691</td>\n","      <td>22.612443</td>\n","      <td>14.760371</td>\n","      <td>1.345624</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>4915 rows × 24 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-dae6d91f-ee67-4ea9-a69f-449a2c11c4fa')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-dae6d91f-ee67-4ea9-a69f-449a2c11c4fa button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-dae6d91f-ee67-4ea9-a69f-449a2c11c4fa');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":67}]},{"cell_type":"code","execution_count":68,"metadata":{"id":"VHxfTuyc7EfM","executionInfo":{"status":"ok","timestamp":1684138666565,"user_tz":-540,"elapsed":10,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"outputs":[],"source":["dataTA.dropna(inplace=True)"]},{"cell_type":"code","execution_count":69,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":0},"executionInfo":{"elapsed":10,"status":"ok","timestamp":1684138666566,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"},"user_tz":-540},"id":"zVxp4Xj07GXz","outputId":"852235dc-9a4e-4d1f-e180-fe88f4cd6388"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                Open      High       Low     Close  Adj Close  Volume  \\\n","Date                                                                    \n","2004-06-25  1.217093  1.220301  1.211299  1.220301   1.220301       0   \n","2004-06-28  1.217493  1.222703  1.212797  1.218695   1.218695       0   \n","2004-06-29  1.218695  1.219096  1.207496  1.209804   1.209804       0   \n","2004-06-30  1.209497  1.220301  1.206797  1.218398   1.218398       0   \n","2004-07-01  1.218294  1.220807  1.213902  1.216205   1.216205       0   \n","...              ...       ...       ...       ...        ...     ...   \n","2022-11-04  0.974963  0.993818  0.974849  0.974963   0.974963       0   \n","2022-11-07  0.992881  1.000500  0.991945  0.992881   0.992881       0   \n","2022-11-08  1.001863  1.009418  0.997606  1.001863   1.001863       0   \n","2022-11-09  1.008085  1.008878  1.001252  1.008085   1.008085       0   \n","2022-11-10  1.001954  1.018299  0.993779  1.001954   1.001954       0   \n","\n","                  RSI       SMA       EMA      EMAF      EMAM      EMAS  \\\n","Date                                                                      \n","2004-06-25  54.911255  1.211252  1.213470  1.212295  1.219270  1.228477   \n","2004-06-28  53.966191  1.212501  1.214420  1.212905  1.219258  1.228347   \n","2004-06-29  48.968246  1.211821  1.213581  1.212610  1.219071  1.228101   \n","2004-06-30  53.434557  1.213591  1.214457  1.213161  1.219058  1.227973   \n","2004-07-01  52.185715  1.214872  1.214775  1.213451  1.219001  1.227817   \n","...               ...       ...       ...       ...       ...       ...   \n","2022-11-04  43.011123  0.990533  0.986115  0.985942  1.007830  1.025200   \n","2022-11-07  53.118878  0.991220  0.987345  0.986603  1.007534  1.024771   \n","2022-11-08  57.196524  0.992542  0.989985  0.988056  1.007421  1.024468   \n","2022-11-09  59.791762  0.993713  0.993276  0.989964  1.007435  1.024251   \n","2022-11-10  56.194274  0.992989  0.994854  0.991106  1.007326  1.023956   \n","\n","            MACD_12_26_9  MACDh_12_26_9  MACDs_12_26_9  BBL_12_2.0  \\\n","Date                                                                 \n","2004-06-25      0.001650       0.000118       0.001532    1.198109   \n","2004-06-28      0.001964       0.000346       0.001618    1.197928   \n","2004-06-29      0.001478      -0.000112       0.001590    1.199894   \n","2004-06-30      0.001766       0.000141       0.001625    1.200897   \n","2004-07-01      0.001797       0.000138       0.001660    1.200904   \n","...                  ...            ...            ...         ...   \n","2022-11-04     -0.000073      -0.000374       0.000301    0.969172   \n","2022-11-07      0.000468       0.000133       0.000335    0.971761   \n","2022-11-08      0.001603       0.001014       0.000588    0.974118   \n","2022-11-09      0.002970       0.001905       0.001065    0.974180   \n","2022-11-10      0.003518       0.001963       0.001555    0.975008   \n","\n","            BBM_12_2.0  BBU_12_2.0  BBB_12_2.0  BBP_12_2.0     ADX_20  \\\n","Date                                                                    \n","2004-06-25    1.210410    1.222711    2.032554    0.902022  10.529251   \n","2004-06-28    1.211060    1.224191    2.168541    0.790725  10.197999   \n","2004-06-29    1.211751    1.223609    1.957117    0.417904   9.797026   \n","2004-06-30    1.212768    1.224639    1.957702    0.737134   9.345300   \n","2004-07-01    1.212734    1.224565    1.950986    0.646672   8.885485   \n","...                ...         ...         ...         ...        ...   \n","2022-11-04    0.988323    1.007473    3.875445    0.151205  10.588025   \n","2022-11-07    0.989675    1.007590    3.620319    0.589474  10.311693   \n","2022-11-08    0.991673    1.009228    3.540559    0.790236  10.453165   \n","2022-11-09    0.993513    1.012845    3.891718    0.876882  10.587564   \n","2022-11-10    0.994621    1.014235    3.943934    0.686923  11.108691   \n","\n","               DMP_20     DMN_20    ROC_12  \n","Date                                        \n","2004-06-25  19.865586  19.370648  1.328905  \n","2004-06-28  20.052943  18.542993  0.643457  \n","2004-06-29  19.049638  19.901794  0.690796  \n","2004-06-30  18.464605  18.752050  1.011273  \n","2004-07-01  18.128930  18.186492 -0.032835  \n","...               ...        ...       ...  \n","2022-11-04  18.945042  19.588859 -1.158250  \n","2022-11-07  19.627748  17.736596  1.662092  \n","2022-11-08  21.704507  16.662629  2.451556  \n","2022-11-09  21.084724  16.186820  2.238945  \n","2022-11-10  22.612443  14.760371  1.345624  \n","\n","[4766 rows x 24 columns]"],"text/html":["\n","  <div id=\"df-bd04452e-3ca4-47b1-9f6c-bd5bdfea31e0\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Open</th>\n","      <th>High</th>\n","      <th>Low</th>\n","      <th>Close</th>\n","      <th>Adj Close</th>\n","      <th>Volume</th>\n","      <th>RSI</th>\n","      <th>SMA</th>\n","      <th>EMA</th>\n","      <th>EMAF</th>\n","      <th>EMAM</th>\n","      <th>EMAS</th>\n","      <th>MACD_12_26_9</th>\n","      <th>MACDh_12_26_9</th>\n","      <th>MACDs_12_26_9</th>\n","      <th>BBL_12_2.0</th>\n","      <th>BBM_12_2.0</th>\n","      <th>BBU_12_2.0</th>\n","      <th>BBB_12_2.0</th>\n","      <th>BBP_12_2.0</th>\n","      <th>ADX_20</th>\n","      <th>DMP_20</th>\n","      <th>DMN_20</th>\n","      <th>ROC_12</th>\n","    </tr>\n","    <tr>\n","      <th>Date</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>2004-06-25</th>\n","      <td>1.217093</td>\n","      <td>1.220301</td>\n","      <td>1.211299</td>\n","      <td>1.220301</td>\n","      <td>1.220301</td>\n","      <td>0</td>\n","      <td>54.911255</td>\n","      <td>1.211252</td>\n","      <td>1.213470</td>\n","      <td>1.212295</td>\n","      <td>1.219270</td>\n","      <td>1.228477</td>\n","      <td>0.001650</td>\n","      <td>0.000118</td>\n","      <td>0.001532</td>\n","      <td>1.198109</td>\n","      <td>1.210410</td>\n","      <td>1.222711</td>\n","      <td>2.032554</td>\n","      <td>0.902022</td>\n","      <td>10.529251</td>\n","      <td>19.865586</td>\n","      <td>19.370648</td>\n","      <td>1.328905</td>\n","    </tr>\n","    <tr>\n","      <th>2004-06-28</th>\n","      <td>1.217493</td>\n","      <td>1.222703</td>\n","      <td>1.212797</td>\n","      <td>1.218695</td>\n","      <td>1.218695</td>\n","      <td>0</td>\n","      <td>53.966191</td>\n","      <td>1.212501</td>\n","      <td>1.214420</td>\n","      <td>1.212905</td>\n","      <td>1.219258</td>\n","      <td>1.228347</td>\n","      <td>0.001964</td>\n","      <td>0.000346</td>\n","      <td>0.001618</td>\n","      <td>1.197928</td>\n","      <td>1.211060</td>\n","      <td>1.224191</td>\n","      <td>2.168541</td>\n","      <td>0.790725</td>\n","      <td>10.197999</td>\n","      <td>20.052943</td>\n","      <td>18.542993</td>\n","      <td>0.643457</td>\n","    </tr>\n","    <tr>\n","      <th>2004-06-29</th>\n","      <td>1.218695</td>\n","      <td>1.219096</td>\n","      <td>1.207496</td>\n","      <td>1.209804</td>\n","      <td>1.209804</td>\n","      <td>0</td>\n","      <td>48.968246</td>\n","      <td>1.211821</td>\n","      <td>1.213581</td>\n","      <td>1.212610</td>\n","      <td>1.219071</td>\n","      <td>1.228101</td>\n","      <td>0.001478</td>\n","      <td>-0.000112</td>\n","      <td>0.001590</td>\n","      <td>1.199894</td>\n","      <td>1.211751</td>\n","      <td>1.223609</td>\n","      <td>1.957117</td>\n","      <td>0.417904</td>\n","      <td>9.797026</td>\n","      <td>19.049638</td>\n","      <td>19.901794</td>\n","      <td>0.690796</td>\n","    </tr>\n","    <tr>\n","      <th>2004-06-30</th>\n","      <td>1.209497</td>\n","      <td>1.220301</td>\n","      <td>1.206797</td>\n","      <td>1.218398</td>\n","      <td>1.218398</td>\n","      <td>0</td>\n","      <td>53.434557</td>\n","      <td>1.213591</td>\n","      <td>1.214457</td>\n","      <td>1.213161</td>\n","      <td>1.219058</td>\n","      <td>1.227973</td>\n","      <td>0.001766</td>\n","      <td>0.000141</td>\n","      <td>0.001625</td>\n","      <td>1.200897</td>\n","      <td>1.212768</td>\n","      <td>1.224639</td>\n","      <td>1.957702</td>\n","      <td>0.737134</td>\n","      <td>9.345300</td>\n","      <td>18.464605</td>\n","      <td>18.752050</td>\n","      <td>1.011273</td>\n","    </tr>\n","    <tr>\n","      <th>2004-07-01</th>\n","      <td>1.218294</td>\n","      <td>1.220807</td>\n","      <td>1.213902</td>\n","      <td>1.216205</td>\n","      <td>1.216205</td>\n","      <td>0</td>\n","      <td>52.185715</td>\n","      <td>1.214872</td>\n","      <td>1.214775</td>\n","      <td>1.213451</td>\n","      <td>1.219001</td>\n","      <td>1.227817</td>\n","      <td>0.001797</td>\n","      <td>0.000138</td>\n","      <td>0.001660</td>\n","      <td>1.200904</td>\n","      <td>1.212734</td>\n","      <td>1.224565</td>\n","      <td>1.950986</td>\n","      <td>0.646672</td>\n","      <td>8.885485</td>\n","      <td>18.128930</td>\n","      <td>18.186492</td>\n","      <td>-0.032835</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-04</th>\n","      <td>0.974963</td>\n","      <td>0.993818</td>\n","      <td>0.974849</td>\n","      <td>0.974963</td>\n","      <td>0.974963</td>\n","      <td>0</td>\n","      <td>43.011123</td>\n","      <td>0.990533</td>\n","      <td>0.986115</td>\n","      <td>0.985942</td>\n","      <td>1.007830</td>\n","      <td>1.025200</td>\n","      <td>-0.000073</td>\n","      <td>-0.000374</td>\n","      <td>0.000301</td>\n","      <td>0.969172</td>\n","      <td>0.988323</td>\n","      <td>1.007473</td>\n","      <td>3.875445</td>\n","      <td>0.151205</td>\n","      <td>10.588025</td>\n","      <td>18.945042</td>\n","      <td>19.588859</td>\n","      <td>-1.158250</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-07</th>\n","      <td>0.992881</td>\n","      <td>1.000500</td>\n","      <td>0.991945</td>\n","      <td>0.992881</td>\n","      <td>0.992881</td>\n","      <td>0</td>\n","      <td>53.118878</td>\n","      <td>0.991220</td>\n","      <td>0.987345</td>\n","      <td>0.986603</td>\n","      <td>1.007534</td>\n","      <td>1.024771</td>\n","      <td>0.000468</td>\n","      <td>0.000133</td>\n","      <td>0.000335</td>\n","      <td>0.971761</td>\n","      <td>0.989675</td>\n","      <td>1.007590</td>\n","      <td>3.620319</td>\n","      <td>0.589474</td>\n","      <td>10.311693</td>\n","      <td>19.627748</td>\n","      <td>17.736596</td>\n","      <td>1.662092</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-08</th>\n","      <td>1.001863</td>\n","      <td>1.009418</td>\n","      <td>0.997606</td>\n","      <td>1.001863</td>\n","      <td>1.001863</td>\n","      <td>0</td>\n","      <td>57.196524</td>\n","      <td>0.992542</td>\n","      <td>0.989985</td>\n","      <td>0.988056</td>\n","      <td>1.007421</td>\n","      <td>1.024468</td>\n","      <td>0.001603</td>\n","      <td>0.001014</td>\n","      <td>0.000588</td>\n","      <td>0.974118</td>\n","      <td>0.991673</td>\n","      <td>1.009228</td>\n","      <td>3.540559</td>\n","      <td>0.790236</td>\n","      <td>10.453165</td>\n","      <td>21.704507</td>\n","      <td>16.662629</td>\n","      <td>2.451556</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-09</th>\n","      <td>1.008085</td>\n","      <td>1.008878</td>\n","      <td>1.001252</td>\n","      <td>1.008085</td>\n","      <td>1.008085</td>\n","      <td>0</td>\n","      <td>59.791762</td>\n","      <td>0.993713</td>\n","      <td>0.993276</td>\n","      <td>0.989964</td>\n","      <td>1.007435</td>\n","      <td>1.024251</td>\n","      <td>0.002970</td>\n","      <td>0.001905</td>\n","      <td>0.001065</td>\n","      <td>0.974180</td>\n","      <td>0.993513</td>\n","      <td>1.012845</td>\n","      <td>3.891718</td>\n","      <td>0.876882</td>\n","      <td>10.587564</td>\n","      <td>21.084724</td>\n","      <td>16.186820</td>\n","      <td>2.238945</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-10</th>\n","      <td>1.001954</td>\n","      <td>1.018299</td>\n","      <td>0.993779</td>\n","      <td>1.001954</td>\n","      <td>1.001954</td>\n","      <td>0</td>\n","      <td>56.194274</td>\n","      <td>0.992989</td>\n","      <td>0.994854</td>\n","      <td>0.991106</td>\n","      <td>1.007326</td>\n","      <td>1.023956</td>\n","      <td>0.003518</td>\n","      <td>0.001963</td>\n","      <td>0.001555</td>\n","      <td>0.975008</td>\n","      <td>0.994621</td>\n","      <td>1.014235</td>\n","      <td>3.943934</td>\n","      <td>0.686923</td>\n","      <td>11.108691</td>\n","      <td>22.612443</td>\n","      <td>14.760371</td>\n","      <td>1.345624</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>4766 rows × 24 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-bd04452e-3ca4-47b1-9f6c-bd5bdfea31e0')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-bd04452e-3ca4-47b1-9f6c-bd5bdfea31e0 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-bd04452e-3ca4-47b1-9f6c-bd5bdfea31e0');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":69}],"source":["data_set = dataTA.iloc[:, ]#.values\n","pd.set_option('display.max_columns', None)\n","\n","data_set"]},{"cell_type":"code","execution_count":70,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":0},"executionInfo":{"elapsed":1359,"status":"ok","timestamp":1684138667915,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"},"user_tz":-540},"id":"33Z3aZxF7K4j","outputId":"4a242d7b-ff88-4c36-b64e-7f32428c343d"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                Open      High       Low     Close  Adj Close  Volume  \\\n","Date                                                                    \n","2013-12-16  1.373815  1.379900  1.373815  1.373928   1.373928       0   \n","2013-12-17  1.376178  1.378210  1.372701  1.376292   1.376292       0   \n","2013-12-18  1.377107  1.378099  1.373479  1.377126   1.377126       0   \n","2013-12-19  1.368307  1.369394  1.365113  1.368495   1.368495       0   \n","2013-12-20  1.365598  1.370870  1.362583  1.365579   1.365579       0   \n","...              ...       ...       ...       ...        ...     ...   \n","2022-11-04  0.974963  0.993818  0.974849  0.974963   0.974963       0   \n","2022-11-07  0.992881  1.000500  0.991945  0.992881   0.992881       0   \n","2022-11-08  1.001863  1.009418  0.997606  1.001863   1.001863       0   \n","2022-11-09  1.008085  1.008878  1.001252  1.008085   1.008085       0   \n","2022-11-10  1.001954  1.018299  0.993779  1.001954   1.001954       0   \n","\n","                  RSI       SMA       EMA      EMAF      EMAM      EMAS  \\\n","Date                                                                      \n","2013-12-16  61.180787  1.368764  1.369946  1.364524  1.347592  1.339880   \n","2013-12-17  62.811095  1.370973  1.371100  1.365645  1.348160  1.340363   \n","2013-12-18  63.392301  1.372779  1.372196  1.366738  1.348734  1.340849   \n","2013-12-19  54.028961  1.373764  1.371523  1.366905  1.349125  1.341216   \n","2013-12-20  51.287513  1.373623  1.370442  1.366779  1.349451  1.341538   \n","...               ...       ...       ...       ...       ...       ...   \n","2022-11-04  43.011123  0.990533  0.986115  0.985942  1.007830  1.025200   \n","2022-11-07  53.118878  0.991220  0.987345  0.986603  1.007534  1.024771   \n","2022-11-08  57.196524  0.992542  0.989985  0.988056  1.007421  1.024468   \n","2022-11-09  59.791762  0.993713  0.993276  0.989964  1.007435  1.024251   \n","2022-11-10  56.194274  0.992989  0.994854  0.991106  1.007326  1.023956   \n","\n","            MACD_12_26_9  MACDh_12_26_9  MACDs_12_26_9  BBL_12_2.0  \\\n","Date                                                                 \n","2013-12-16      0.005894       0.002006       0.003889    1.350766   \n","2013-12-17      0.006076       0.001750       0.004326    1.351940   \n","2013-12-18      0.006216       0.001512       0.004704    1.354059   \n","2013-12-19      0.005567       0.000690       0.004877    1.358317   \n","2013-12-20      0.004762      -0.000092       0.004854    1.360510   \n","...                  ...            ...            ...         ...   \n","2022-11-04     -0.000073      -0.000374       0.000301    0.969172   \n","2022-11-07      0.000468       0.000133       0.000335    0.971761   \n","2022-11-08      0.001603       0.001014       0.000588    0.974118   \n","2022-11-09      0.002970       0.001905       0.001065    0.974180   \n","2022-11-10      0.003518       0.001963       0.001555    0.975008   \n","\n","            BBM_12_2.0  BBU_12_2.0  BBB_12_2.0  BBP_12_2.0     ADX_20  \\\n","Date                                                                    \n","2013-12-16    1.367213    1.383660    2.405920    0.704164  15.357994   \n","2013-12-17    1.368537    1.385135    2.425581    0.733614  15.493713   \n","2013-12-18    1.370088    1.386118    2.339867    0.719524  15.622646   \n","2013-12-19    1.371279    1.384242    1.890574    0.392590  14.973438   \n","2013-12-20    1.371822    1.383133    1.649117    0.224048  14.297832   \n","...                ...         ...         ...         ...        ...   \n","2022-11-04    0.988323    1.007473    3.875445    0.151205  10.588025   \n","2022-11-07    0.989675    1.007590    3.620319    0.589474  10.311693   \n","2022-11-08    0.991673    1.009228    3.540559    0.790236  10.453165   \n","2022-11-09    0.993513    1.012845    3.891718    0.876882  10.587564   \n","2022-11-10    0.994621    1.014235    3.943934    0.686923  11.108691   \n","\n","               DMP_20     DMN_20    ROC_12  \n","Date                                        \n","2013-12-16  22.396920  14.854837  1.220049  \n","2013-12-17  21.662505  15.031101  1.168472  \n","2013-12-18  21.053065  14.608225  1.370242  \n","2013-12-19  19.547899  18.542880  1.055106  \n","2013-12-20  18.583230  19.134403  0.479314  \n","...               ...        ...       ...  \n","2022-11-04  18.945042  19.588859 -1.158250  \n","2022-11-07  19.627748  17.736596  1.662092  \n","2022-11-08  21.704507  16.662629  2.451556  \n","2022-11-09  21.084724  16.186820  2.238945  \n","2022-11-10  22.612443  14.760371  1.345624  \n","\n","[2321 rows x 24 columns]"],"text/html":["\n","  <div id=\"df-d2f421b0-ef6e-4f50-a42b-7158370365eb\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Open</th>\n","      <th>High</th>\n","      <th>Low</th>\n","      <th>Close</th>\n","      <th>Adj Close</th>\n","      <th>Volume</th>\n","      <th>RSI</th>\n","      <th>SMA</th>\n","      <th>EMA</th>\n","      <th>EMAF</th>\n","      <th>EMAM</th>\n","      <th>EMAS</th>\n","      <th>MACD_12_26_9</th>\n","      <th>MACDh_12_26_9</th>\n","      <th>MACDs_12_26_9</th>\n","      <th>BBL_12_2.0</th>\n","      <th>BBM_12_2.0</th>\n","      <th>BBU_12_2.0</th>\n","      <th>BBB_12_2.0</th>\n","      <th>BBP_12_2.0</th>\n","      <th>ADX_20</th>\n","      <th>DMP_20</th>\n","      <th>DMN_20</th>\n","      <th>ROC_12</th>\n","    </tr>\n","    <tr>\n","      <th>Date</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>2013-12-16</th>\n","      <td>1.373815</td>\n","      <td>1.379900</td>\n","      <td>1.373815</td>\n","      <td>1.373928</td>\n","      <td>1.373928</td>\n","      <td>0</td>\n","      <td>61.180787</td>\n","      <td>1.368764</td>\n","      <td>1.369946</td>\n","      <td>1.364524</td>\n","      <td>1.347592</td>\n","      <td>1.339880</td>\n","      <td>0.005894</td>\n","      <td>0.002006</td>\n","      <td>0.003889</td>\n","      <td>1.350766</td>\n","      <td>1.367213</td>\n","      <td>1.383660</td>\n","      <td>2.405920</td>\n","      <td>0.704164</td>\n","      <td>15.357994</td>\n","      <td>22.396920</td>\n","      <td>14.854837</td>\n","      <td>1.220049</td>\n","    </tr>\n","    <tr>\n","      <th>2013-12-17</th>\n","      <td>1.376178</td>\n","      <td>1.378210</td>\n","      <td>1.372701</td>\n","      <td>1.376292</td>\n","      <td>1.376292</td>\n","      <td>0</td>\n","      <td>62.811095</td>\n","      <td>1.370973</td>\n","      <td>1.371100</td>\n","      <td>1.365645</td>\n","      <td>1.348160</td>\n","      <td>1.340363</td>\n","      <td>0.006076</td>\n","      <td>0.001750</td>\n","      <td>0.004326</td>\n","      <td>1.351940</td>\n","      <td>1.368537</td>\n","      <td>1.385135</td>\n","      <td>2.425581</td>\n","      <td>0.733614</td>\n","      <td>15.493713</td>\n","      <td>21.662505</td>\n","      <td>15.031101</td>\n","      <td>1.168472</td>\n","    </tr>\n","    <tr>\n","      <th>2013-12-18</th>\n","      <td>1.377107</td>\n","      <td>1.378099</td>\n","      <td>1.373479</td>\n","      <td>1.377126</td>\n","      <td>1.377126</td>\n","      <td>0</td>\n","      <td>63.392301</td>\n","      <td>1.372779</td>\n","      <td>1.372196</td>\n","      <td>1.366738</td>\n","      <td>1.348734</td>\n","      <td>1.340849</td>\n","      <td>0.006216</td>\n","      <td>0.001512</td>\n","      <td>0.004704</td>\n","      <td>1.354059</td>\n","      <td>1.370088</td>\n","      <td>1.386118</td>\n","      <td>2.339867</td>\n","      <td>0.719524</td>\n","      <td>15.622646</td>\n","      <td>21.053065</td>\n","      <td>14.608225</td>\n","      <td>1.370242</td>\n","    </tr>\n","    <tr>\n","      <th>2013-12-19</th>\n","      <td>1.368307</td>\n","      <td>1.369394</td>\n","      <td>1.365113</td>\n","      <td>1.368495</td>\n","      <td>1.368495</td>\n","      <td>0</td>\n","      <td>54.028961</td>\n","      <td>1.373764</td>\n","      <td>1.371523</td>\n","      <td>1.366905</td>\n","      <td>1.349125</td>\n","      <td>1.341216</td>\n","      <td>0.005567</td>\n","      <td>0.000690</td>\n","      <td>0.004877</td>\n","      <td>1.358317</td>\n","      <td>1.371279</td>\n","      <td>1.384242</td>\n","      <td>1.890574</td>\n","      <td>0.392590</td>\n","      <td>14.973438</td>\n","      <td>19.547899</td>\n","      <td>18.542880</td>\n","      <td>1.055106</td>\n","    </tr>\n","    <tr>\n","      <th>2013-12-20</th>\n","      <td>1.365598</td>\n","      <td>1.370870</td>\n","      <td>1.362583</td>\n","      <td>1.365579</td>\n","      <td>1.365579</td>\n","      <td>0</td>\n","      <td>51.287513</td>\n","      <td>1.373623</td>\n","      <td>1.370442</td>\n","      <td>1.366779</td>\n","      <td>1.349451</td>\n","      <td>1.341538</td>\n","      <td>0.004762</td>\n","      <td>-0.000092</td>\n","      <td>0.004854</td>\n","      <td>1.360510</td>\n","      <td>1.371822</td>\n","      <td>1.383133</td>\n","      <td>1.649117</td>\n","      <td>0.224048</td>\n","      <td>14.297832</td>\n","      <td>18.583230</td>\n","      <td>19.134403</td>\n","      <td>0.479314</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-04</th>\n","      <td>0.974963</td>\n","      <td>0.993818</td>\n","      <td>0.974849</td>\n","      <td>0.974963</td>\n","      <td>0.974963</td>\n","      <td>0</td>\n","      <td>43.011123</td>\n","      <td>0.990533</td>\n","      <td>0.986115</td>\n","      <td>0.985942</td>\n","      <td>1.007830</td>\n","      <td>1.025200</td>\n","      <td>-0.000073</td>\n","      <td>-0.000374</td>\n","      <td>0.000301</td>\n","      <td>0.969172</td>\n","      <td>0.988323</td>\n","      <td>1.007473</td>\n","      <td>3.875445</td>\n","      <td>0.151205</td>\n","      <td>10.588025</td>\n","      <td>18.945042</td>\n","      <td>19.588859</td>\n","      <td>-1.158250</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-07</th>\n","      <td>0.992881</td>\n","      <td>1.000500</td>\n","      <td>0.991945</td>\n","      <td>0.992881</td>\n","      <td>0.992881</td>\n","      <td>0</td>\n","      <td>53.118878</td>\n","      <td>0.991220</td>\n","      <td>0.987345</td>\n","      <td>0.986603</td>\n","      <td>1.007534</td>\n","      <td>1.024771</td>\n","      <td>0.000468</td>\n","      <td>0.000133</td>\n","      <td>0.000335</td>\n","      <td>0.971761</td>\n","      <td>0.989675</td>\n","      <td>1.007590</td>\n","      <td>3.620319</td>\n","      <td>0.589474</td>\n","      <td>10.311693</td>\n","      <td>19.627748</td>\n","      <td>17.736596</td>\n","      <td>1.662092</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-08</th>\n","      <td>1.001863</td>\n","      <td>1.009418</td>\n","      <td>0.997606</td>\n","      <td>1.001863</td>\n","      <td>1.001863</td>\n","      <td>0</td>\n","      <td>57.196524</td>\n","      <td>0.992542</td>\n","      <td>0.989985</td>\n","      <td>0.988056</td>\n","      <td>1.007421</td>\n","      <td>1.024468</td>\n","      <td>0.001603</td>\n","      <td>0.001014</td>\n","      <td>0.000588</td>\n","      <td>0.974118</td>\n","      <td>0.991673</td>\n","      <td>1.009228</td>\n","      <td>3.540559</td>\n","      <td>0.790236</td>\n","      <td>10.453165</td>\n","      <td>21.704507</td>\n","      <td>16.662629</td>\n","      <td>2.451556</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-09</th>\n","      <td>1.008085</td>\n","      <td>1.008878</td>\n","      <td>1.001252</td>\n","      <td>1.008085</td>\n","      <td>1.008085</td>\n","      <td>0</td>\n","      <td>59.791762</td>\n","      <td>0.993713</td>\n","      <td>0.993276</td>\n","      <td>0.989964</td>\n","      <td>1.007435</td>\n","      <td>1.024251</td>\n","      <td>0.002970</td>\n","      <td>0.001905</td>\n","      <td>0.001065</td>\n","      <td>0.974180</td>\n","      <td>0.993513</td>\n","      <td>1.012845</td>\n","      <td>3.891718</td>\n","      <td>0.876882</td>\n","      <td>10.587564</td>\n","      <td>21.084724</td>\n","      <td>16.186820</td>\n","      <td>2.238945</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-10</th>\n","      <td>1.001954</td>\n","      <td>1.018299</td>\n","      <td>0.993779</td>\n","      <td>1.001954</td>\n","      <td>1.001954</td>\n","      <td>0</td>\n","      <td>56.194274</td>\n","      <td>0.992989</td>\n","      <td>0.994854</td>\n","      <td>0.991106</td>\n","      <td>1.007326</td>\n","      <td>1.023956</td>\n","      <td>0.003518</td>\n","      <td>0.001963</td>\n","      <td>0.001555</td>\n","      <td>0.975008</td>\n","      <td>0.994621</td>\n","      <td>1.014235</td>\n","      <td>3.943934</td>\n","      <td>0.686923</td>\n","      <td>11.108691</td>\n","      <td>22.612443</td>\n","      <td>14.760371</td>\n","      <td>1.345624</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>2321 rows × 24 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d2f421b0-ef6e-4f50-a42b-7158370365eb')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-d2f421b0-ef6e-4f50-a42b-7158370365eb button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-d2f421b0-ef6e-4f50-a42b-7158370365eb');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":70}],"source":["data_set=data_set.drop(data_set.index[0:2445])\n","data_set"]},{"cell_type":"code","source":["# Reset index for 2 datasets df_final and data_set\n","df_final = df_final.reset_index(drop=False)\n","data_set = data_set.reset_index(drop=False)"],"metadata":{"id":"LhuDOqpHT2G9","executionInfo":{"status":"ok","timestamp":1684138667916,"user_tz":-540,"elapsed":12,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"execution_count":71,"outputs":[]},{"cell_type":"code","source":["df_final['Date']= pd.to_datetime(df_final['Date']) \n","data_set['Date']= pd.to_datetime(data_set['Date']) "],"metadata":{"id":"x3mAGzcOVSek","executionInfo":{"status":"ok","timestamp":1684138667917,"user_tz":-540,"elapsed":12,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"execution_count":72,"outputs":[]},{"cell_type":"code","source":["#Merging 2 datasets df_final and data_set\n","data_final = pd.merge(data_set, df_final,how='left',left_on='Date', right_on='Date')\n","data_final"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":0},"id":"u_6f5VVMTdeP","executionInfo":{"status":"ok","timestamp":1684138667917,"user_tz":-540,"elapsed":12,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}},"outputId":"50541a1d-e55f-49a1-95c6-8a3267703d36"},"execution_count":73,"outputs":[{"output_type":"execute_result","data":{"text/plain":["           Date    Open_x    High_x     Low_x   Close_x  Adj Close_x  Volume  \\\n","0    2013-12-16  1.373815  1.379900  1.373815  1.373928     1.373928       0   \n","1    2013-12-17  1.376178  1.378210  1.372701  1.376292     1.376292       0   \n","2    2013-12-18  1.377107  1.378099  1.373479  1.377126     1.377126       0   \n","3    2013-12-19  1.368307  1.369394  1.365113  1.368495     1.368495       0   \n","4    2013-12-20  1.365598  1.370870  1.362583  1.365579     1.365579       0   \n","...         ...       ...       ...       ...       ...          ...     ...   \n","2316 2022-11-04  0.974963  0.993818  0.974849  0.974963     0.974963       0   \n","2317 2022-11-07  0.992881  1.000500  0.991945  0.992881     0.992881       0   \n","2318 2022-11-08  1.001863  1.009418  0.997606  1.001863     1.001863       0   \n","2319 2022-11-09  1.008085  1.008878  1.001252  1.008085     1.008085       0   \n","2320 2022-11-10  1.001954  1.018299  0.993779  1.001954     1.001954       0   \n","\n","            RSI       SMA       EMA      EMAF      EMAM      EMAS  \\\n","0     61.180787  1.368764  1.369946  1.364524  1.347592  1.339880   \n","1     62.811095  1.370973  1.371100  1.365645  1.348160  1.340363   \n","2     63.392301  1.372779  1.372196  1.366738  1.348734  1.340849   \n","3     54.028961  1.373764  1.371523  1.366905  1.349125  1.341216   \n","4     51.287513  1.373623  1.370442  1.366779  1.349451  1.341538   \n","...         ...       ...       ...       ...       ...       ...   \n","2316  43.011123  0.990533  0.986115  0.985942  1.007830  1.025200   \n","2317  53.118878  0.991220  0.987345  0.986603  1.007534  1.024771   \n","2318  57.196524  0.992542  0.989985  0.988056  1.007421  1.024468   \n","2319  59.791762  0.993713  0.993276  0.989964  1.007435  1.024251   \n","2320  56.194274  0.992989  0.994854  0.991106  1.007326  1.023956   \n","\n","      MACD_12_26_9  MACDh_12_26_9  MACDs_12_26_9  BBL_12_2.0  BBM_12_2.0  \\\n","0         0.005894       0.002006       0.003889    1.350766    1.367213   \n","1         0.006076       0.001750       0.004326    1.351940    1.368537   \n","2         0.006216       0.001512       0.004704    1.354059    1.370088   \n","3         0.005567       0.000690       0.004877    1.358317    1.371279   \n","4         0.004762      -0.000092       0.004854    1.360510    1.371822   \n","...            ...            ...            ...         ...         ...   \n","2316     -0.000073      -0.000374       0.000301    0.969172    0.988323   \n","2317      0.000468       0.000133       0.000335    0.971761    0.989675   \n","2318      0.001603       0.001014       0.000588    0.974118    0.991673   \n","2319      0.002970       0.001905       0.001065    0.974180    0.993513   \n","2320      0.003518       0.001963       0.001555    0.975008    0.994621   \n","\n","      BBU_12_2.0  BBB_12_2.0  BBP_12_2.0     ADX_20     DMP_20     DMN_20  \\\n","0       1.383660    2.405920    0.704164  15.357994  22.396920  14.854837   \n","1       1.385135    2.425581    0.733614  15.493713  21.662505  15.031101   \n","2       1.386118    2.339867    0.719524  15.622646  21.053065  14.608225   \n","3       1.384242    1.890574    0.392590  14.973438  19.547899  18.542880   \n","4       1.383133    1.649117    0.224048  14.297832  18.583230  19.134403   \n","...          ...         ...         ...        ...        ...        ...   \n","2316    1.007473    3.875445    0.151205  10.588025  18.945042  19.588859   \n","2317    1.007590    3.620319    0.589474  10.311693  19.627748  17.736596   \n","2318    1.009228    3.540559    0.790236  10.453165  21.704507  16.662629   \n","2319    1.012845    3.891718    0.876882  10.587564  21.084724  16.186820   \n","2320    1.014235    3.943934    0.686923  11.108691  22.612443  14.760371   \n","\n","        ROC_12    Open_y    High_y     Low_y   Close_y  Adj Close_y  \\\n","0     1.220049  1.373815  1.379900  1.373815  1.373928     1.373928   \n","1     1.168472  1.376178  1.378210  1.372701  1.376292     1.376292   \n","2     1.370242  1.377107  1.378099  1.373479  1.377126     1.377126   \n","3     1.055106  1.368307  1.369394  1.365113  1.368495     1.368495   \n","4     0.479314  1.365598  1.370870  1.362583  1.365579     1.365579   \n","...        ...       ...       ...       ...       ...          ...   \n","2316 -1.158250  0.974963  0.993818  0.974849  0.974963     0.974963   \n","2317  1.662092  0.992881  1.000500  0.991945  0.992881     0.992881   \n","2318  2.451556  1.001863  1.009418  0.997606  1.001863     1.001863   \n","2319  2.238945  1.008085  1.008878  1.001252  1.008085     1.008085   \n","2320  1.345624  1.001954  1.018299  0.993779  1.001954     1.001954   \n","\n","      sentiment  returnsclass  \n","0     -0.014925             0  \n","1     -0.108911             1  \n","2     -0.006410             1  \n","3      0.068493             0  \n","4     -0.074380             0  \n","...         ...           ...  \n","2316  -0.120438             0  \n","2317  -0.213805             1  \n","2318  -0.148820             1  \n","2319  -0.138081             1  \n","2320  -0.173095             0  \n","\n","[2321 rows x 32 columns]"],"text/html":["\n","  <div id=\"df-d29d0080-6607-4ade-8d61-5ed661acbbfc\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Date</th>\n","      <th>Open_x</th>\n","      <th>High_x</th>\n","      <th>Low_x</th>\n","      <th>Close_x</th>\n","      <th>Adj Close_x</th>\n","      <th>Volume</th>\n","      <th>RSI</th>\n","      <th>SMA</th>\n","      <th>EMA</th>\n","      <th>EMAF</th>\n","      <th>EMAM</th>\n","      <th>EMAS</th>\n","      <th>MACD_12_26_9</th>\n","      <th>MACDh_12_26_9</th>\n","      <th>MACDs_12_26_9</th>\n","      <th>BBL_12_2.0</th>\n","      <th>BBM_12_2.0</th>\n","      <th>BBU_12_2.0</th>\n","      <th>BBB_12_2.0</th>\n","      <th>BBP_12_2.0</th>\n","      <th>ADX_20</th>\n","      <th>DMP_20</th>\n","      <th>DMN_20</th>\n","      <th>ROC_12</th>\n","      <th>Open_y</th>\n","      <th>High_y</th>\n","      <th>Low_y</th>\n","      <th>Close_y</th>\n","      <th>Adj Close_y</th>\n","      <th>sentiment</th>\n","      <th>returnsclass</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>2013-12-16</td>\n","      <td>1.373815</td>\n","      <td>1.379900</td>\n","      <td>1.373815</td>\n","      <td>1.373928</td>\n","      <td>1.373928</td>\n","      <td>0</td>\n","      <td>61.180787</td>\n","      <td>1.368764</td>\n","      <td>1.369946</td>\n","      <td>1.364524</td>\n","      <td>1.347592</td>\n","      <td>1.339880</td>\n","      <td>0.005894</td>\n","      <td>0.002006</td>\n","      <td>0.003889</td>\n","      <td>1.350766</td>\n","      <td>1.367213</td>\n","      <td>1.383660</td>\n","      <td>2.405920</td>\n","      <td>0.704164</td>\n","      <td>15.357994</td>\n","      <td>22.396920</td>\n","      <td>14.854837</td>\n","      <td>1.220049</td>\n","      <td>1.373815</td>\n","      <td>1.379900</td>\n","      <td>1.373815</td>\n","      <td>1.373928</td>\n","      <td>1.373928</td>\n","      <td>-0.014925</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2013-12-17</td>\n","      <td>1.376178</td>\n","      <td>1.378210</td>\n","      <td>1.372701</td>\n","      <td>1.376292</td>\n","      <td>1.376292</td>\n","      <td>0</td>\n","      <td>62.811095</td>\n","      <td>1.370973</td>\n","      <td>1.371100</td>\n","      <td>1.365645</td>\n","      <td>1.348160</td>\n","      <td>1.340363</td>\n","      <td>0.006076</td>\n","      <td>0.001750</td>\n","      <td>0.004326</td>\n","      <td>1.351940</td>\n","      <td>1.368537</td>\n","      <td>1.385135</td>\n","      <td>2.425581</td>\n","      <td>0.733614</td>\n","      <td>15.493713</td>\n","      <td>21.662505</td>\n","      <td>15.031101</td>\n","      <td>1.168472</td>\n","      <td>1.376178</td>\n","      <td>1.378210</td>\n","      <td>1.372701</td>\n","      <td>1.376292</td>\n","      <td>1.376292</td>\n","      <td>-0.108911</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2013-12-18</td>\n","      <td>1.377107</td>\n","      <td>1.378099</td>\n","      <td>1.373479</td>\n","      <td>1.377126</td>\n","      <td>1.377126</td>\n","      <td>0</td>\n","      <td>63.392301</td>\n","      <td>1.372779</td>\n","      <td>1.372196</td>\n","      <td>1.366738</td>\n","      <td>1.348734</td>\n","      <td>1.340849</td>\n","      <td>0.006216</td>\n","      <td>0.001512</td>\n","      <td>0.004704</td>\n","      <td>1.354059</td>\n","      <td>1.370088</td>\n","      <td>1.386118</td>\n","      <td>2.339867</td>\n","      <td>0.719524</td>\n","      <td>15.622646</td>\n","      <td>21.053065</td>\n","      <td>14.608225</td>\n","      <td>1.370242</td>\n","      <td>1.377107</td>\n","      <td>1.378099</td>\n","      <td>1.373479</td>\n","      <td>1.377126</td>\n","      <td>1.377126</td>\n","      <td>-0.006410</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>2013-12-19</td>\n","      <td>1.368307</td>\n","      <td>1.369394</td>\n","      <td>1.365113</td>\n","      <td>1.368495</td>\n","      <td>1.368495</td>\n","      <td>0</td>\n","      <td>54.028961</td>\n","      <td>1.373764</td>\n","      <td>1.371523</td>\n","      <td>1.366905</td>\n","      <td>1.349125</td>\n","      <td>1.341216</td>\n","      <td>0.005567</td>\n","      <td>0.000690</td>\n","      <td>0.004877</td>\n","      <td>1.358317</td>\n","      <td>1.371279</td>\n","      <td>1.384242</td>\n","      <td>1.890574</td>\n","      <td>0.392590</td>\n","      <td>14.973438</td>\n","      <td>19.547899</td>\n","      <td>18.542880</td>\n","      <td>1.055106</td>\n","      <td>1.368307</td>\n","      <td>1.369394</td>\n","      <td>1.365113</td>\n","      <td>1.368495</td>\n","      <td>1.368495</td>\n","      <td>0.068493</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>2013-12-20</td>\n","      <td>1.365598</td>\n","      <td>1.370870</td>\n","      <td>1.362583</td>\n","      <td>1.365579</td>\n","      <td>1.365579</td>\n","      <td>0</td>\n","      <td>51.287513</td>\n","      <td>1.373623</td>\n","      <td>1.370442</td>\n","      <td>1.366779</td>\n","      <td>1.349451</td>\n","      <td>1.341538</td>\n","      <td>0.004762</td>\n","      <td>-0.000092</td>\n","      <td>0.004854</td>\n","      <td>1.360510</td>\n","      <td>1.371822</td>\n","      <td>1.383133</td>\n","      <td>1.649117</td>\n","      <td>0.224048</td>\n","      <td>14.297832</td>\n","      <td>18.583230</td>\n","      <td>19.134403</td>\n","      <td>0.479314</td>\n","      <td>1.365598</td>\n","      <td>1.370870</td>\n","      <td>1.362583</td>\n","      <td>1.365579</td>\n","      <td>1.365579</td>\n","      <td>-0.074380</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>2316</th>\n","      <td>2022-11-04</td>\n","      <td>0.974963</td>\n","      <td>0.993818</td>\n","      <td>0.974849</td>\n","      <td>0.974963</td>\n","      <td>0.974963</td>\n","      <td>0</td>\n","      <td>43.011123</td>\n","      <td>0.990533</td>\n","      <td>0.986115</td>\n","      <td>0.985942</td>\n","      <td>1.007830</td>\n","      <td>1.025200</td>\n","      <td>-0.000073</td>\n","      <td>-0.000374</td>\n","      <td>0.000301</td>\n","      <td>0.969172</td>\n","      <td>0.988323</td>\n","      <td>1.007473</td>\n","      <td>3.875445</td>\n","      <td>0.151205</td>\n","      <td>10.588025</td>\n","      <td>18.945042</td>\n","      <td>19.588859</td>\n","      <td>-1.158250</td>\n","      <td>0.974963</td>\n","      <td>0.993818</td>\n","      <td>0.974849</td>\n","      <td>0.974963</td>\n","      <td>0.974963</td>\n","      <td>-0.120438</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2317</th>\n","      <td>2022-11-07</td>\n","      <td>0.992881</td>\n","      <td>1.000500</td>\n","      <td>0.991945</td>\n","      <td>0.992881</td>\n","      <td>0.992881</td>\n","      <td>0</td>\n","      <td>53.118878</td>\n","      <td>0.991220</td>\n","      <td>0.987345</td>\n","      <td>0.986603</td>\n","      <td>1.007534</td>\n","      <td>1.024771</td>\n","      <td>0.000468</td>\n","      <td>0.000133</td>\n","      <td>0.000335</td>\n","      <td>0.971761</td>\n","      <td>0.989675</td>\n","      <td>1.007590</td>\n","      <td>3.620319</td>\n","      <td>0.589474</td>\n","      <td>10.311693</td>\n","      <td>19.627748</td>\n","      <td>17.736596</td>\n","      <td>1.662092</td>\n","      <td>0.992881</td>\n","      <td>1.000500</td>\n","      <td>0.991945</td>\n","      <td>0.992881</td>\n","      <td>0.992881</td>\n","      <td>-0.213805</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2318</th>\n","      <td>2022-11-08</td>\n","      <td>1.001863</td>\n","      <td>1.009418</td>\n","      <td>0.997606</td>\n","      <td>1.001863</td>\n","      <td>1.001863</td>\n","      <td>0</td>\n","      <td>57.196524</td>\n","      <td>0.992542</td>\n","      <td>0.989985</td>\n","      <td>0.988056</td>\n","      <td>1.007421</td>\n","      <td>1.024468</td>\n","      <td>0.001603</td>\n","      <td>0.001014</td>\n","      <td>0.000588</td>\n","      <td>0.974118</td>\n","      <td>0.991673</td>\n","      <td>1.009228</td>\n","      <td>3.540559</td>\n","      <td>0.790236</td>\n","      <td>10.453165</td>\n","      <td>21.704507</td>\n","      <td>16.662629</td>\n","      <td>2.451556</td>\n","      <td>1.001863</td>\n","      <td>1.009418</td>\n","      <td>0.997606</td>\n","      <td>1.001863</td>\n","      <td>1.001863</td>\n","      <td>-0.148820</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2319</th>\n","      <td>2022-11-09</td>\n","      <td>1.008085</td>\n","      <td>1.008878</td>\n","      <td>1.001252</td>\n","      <td>1.008085</td>\n","      <td>1.008085</td>\n","      <td>0</td>\n","      <td>59.791762</td>\n","      <td>0.993713</td>\n","      <td>0.993276</td>\n","      <td>0.989964</td>\n","      <td>1.007435</td>\n","      <td>1.024251</td>\n","      <td>0.002970</td>\n","      <td>0.001905</td>\n","      <td>0.001065</td>\n","      <td>0.974180</td>\n","      <td>0.993513</td>\n","      <td>1.012845</td>\n","      <td>3.891718</td>\n","      <td>0.876882</td>\n","      <td>10.587564</td>\n","      <td>21.084724</td>\n","      <td>16.186820</td>\n","      <td>2.238945</td>\n","      <td>1.008085</td>\n","      <td>1.008878</td>\n","      <td>1.001252</td>\n","      <td>1.008085</td>\n","      <td>1.008085</td>\n","      <td>-0.138081</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2320</th>\n","      <td>2022-11-10</td>\n","      <td>1.001954</td>\n","      <td>1.018299</td>\n","      <td>0.993779</td>\n","      <td>1.001954</td>\n","      <td>1.001954</td>\n","      <td>0</td>\n","      <td>56.194274</td>\n","      <td>0.992989</td>\n","      <td>0.994854</td>\n","      <td>0.991106</td>\n","      <td>1.007326</td>\n","      <td>1.023956</td>\n","      <td>0.003518</td>\n","      <td>0.001963</td>\n","      <td>0.001555</td>\n","      <td>0.975008</td>\n","      <td>0.994621</td>\n","      <td>1.014235</td>\n","      <td>3.943934</td>\n","      <td>0.686923</td>\n","      <td>11.108691</td>\n","      <td>22.612443</td>\n","      <td>14.760371</td>\n","      <td>1.345624</td>\n","      <td>1.001954</td>\n","      <td>1.018299</td>\n","      <td>0.993779</td>\n","      <td>1.001954</td>\n","      <td>1.001954</td>\n","      <td>-0.173095</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>2321 rows × 32 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d29d0080-6607-4ade-8d61-5ed661acbbfc')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-d29d0080-6607-4ade-8d61-5ed661acbbfc button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-d29d0080-6607-4ade-8d61-5ed661acbbfc');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":73}]},{"cell_type":"code","source":["data_final.drop(['Volume','Open_y','High_y','Low_y', 'Close_y', 'Adj Close_y'], axis = 1, inplace= True)\n","data_final"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":0},"id":"KrXHgQ41azuQ","executionInfo":{"status":"ok","timestamp":1684138667917,"user_tz":-540,"elapsed":11,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}},"outputId":"a1687915-a2bb-4bf9-dcff-b7d5f6cba40b"},"execution_count":74,"outputs":[{"output_type":"execute_result","data":{"text/plain":["           Date    Open_x    High_x     Low_x   Close_x  Adj Close_x  \\\n","0    2013-12-16  1.373815  1.379900  1.373815  1.373928     1.373928   \n","1    2013-12-17  1.376178  1.378210  1.372701  1.376292     1.376292   \n","2    2013-12-18  1.377107  1.378099  1.373479  1.377126     1.377126   \n","3    2013-12-19  1.368307  1.369394  1.365113  1.368495     1.368495   \n","4    2013-12-20  1.365598  1.370870  1.362583  1.365579     1.365579   \n","...         ...       ...       ...       ...       ...          ...   \n","2316 2022-11-04  0.974963  0.993818  0.974849  0.974963     0.974963   \n","2317 2022-11-07  0.992881  1.000500  0.991945  0.992881     0.992881   \n","2318 2022-11-08  1.001863  1.009418  0.997606  1.001863     1.001863   \n","2319 2022-11-09  1.008085  1.008878  1.001252  1.008085     1.008085   \n","2320 2022-11-10  1.001954  1.018299  0.993779  1.001954     1.001954   \n","\n","            RSI       SMA       EMA      EMAF      EMAM      EMAS  \\\n","0     61.180787  1.368764  1.369946  1.364524  1.347592  1.339880   \n","1     62.811095  1.370973  1.371100  1.365645  1.348160  1.340363   \n","2     63.392301  1.372779  1.372196  1.366738  1.348734  1.340849   \n","3     54.028961  1.373764  1.371523  1.366905  1.349125  1.341216   \n","4     51.287513  1.373623  1.370442  1.366779  1.349451  1.341538   \n","...         ...       ...       ...       ...       ...       ...   \n","2316  43.011123  0.990533  0.986115  0.985942  1.007830  1.025200   \n","2317  53.118878  0.991220  0.987345  0.986603  1.007534  1.024771   \n","2318  57.196524  0.992542  0.989985  0.988056  1.007421  1.024468   \n","2319  59.791762  0.993713  0.993276  0.989964  1.007435  1.024251   \n","2320  56.194274  0.992989  0.994854  0.991106  1.007326  1.023956   \n","\n","      MACD_12_26_9  MACDh_12_26_9  MACDs_12_26_9  BBL_12_2.0  BBM_12_2.0  \\\n","0         0.005894       0.002006       0.003889    1.350766    1.367213   \n","1         0.006076       0.001750       0.004326    1.351940    1.368537   \n","2         0.006216       0.001512       0.004704    1.354059    1.370088   \n","3         0.005567       0.000690       0.004877    1.358317    1.371279   \n","4         0.004762      -0.000092       0.004854    1.360510    1.371822   \n","...            ...            ...            ...         ...         ...   \n","2316     -0.000073      -0.000374       0.000301    0.969172    0.988323   \n","2317      0.000468       0.000133       0.000335    0.971761    0.989675   \n","2318      0.001603       0.001014       0.000588    0.974118    0.991673   \n","2319      0.002970       0.001905       0.001065    0.974180    0.993513   \n","2320      0.003518       0.001963       0.001555    0.975008    0.994621   \n","\n","      BBU_12_2.0  BBB_12_2.0  BBP_12_2.0     ADX_20     DMP_20     DMN_20  \\\n","0       1.383660    2.405920    0.704164  15.357994  22.396920  14.854837   \n","1       1.385135    2.425581    0.733614  15.493713  21.662505  15.031101   \n","2       1.386118    2.339867    0.719524  15.622646  21.053065  14.608225   \n","3       1.384242    1.890574    0.392590  14.973438  19.547899  18.542880   \n","4       1.383133    1.649117    0.224048  14.297832  18.583230  19.134403   \n","...          ...         ...         ...        ...        ...        ...   \n","2316    1.007473    3.875445    0.151205  10.588025  18.945042  19.588859   \n","2317    1.007590    3.620319    0.589474  10.311693  19.627748  17.736596   \n","2318    1.009228    3.540559    0.790236  10.453165  21.704507  16.662629   \n","2319    1.012845    3.891718    0.876882  10.587564  21.084724  16.186820   \n","2320    1.014235    3.943934    0.686923  11.108691  22.612443  14.760371   \n","\n","        ROC_12  sentiment  returnsclass  \n","0     1.220049  -0.014925             0  \n","1     1.168472  -0.108911             1  \n","2     1.370242  -0.006410             1  \n","3     1.055106   0.068493             0  \n","4     0.479314  -0.074380             0  \n","...        ...        ...           ...  \n","2316 -1.158250  -0.120438             0  \n","2317  1.662092  -0.213805             1  \n","2318  2.451556  -0.148820             1  \n","2319  2.238945  -0.138081             1  \n","2320  1.345624  -0.173095             0  \n","\n","[2321 rows x 26 columns]"],"text/html":["\n","  <div id=\"df-b17c6755-db0b-4fd1-9a0c-ddebc3968de1\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Date</th>\n","      <th>Open_x</th>\n","      <th>High_x</th>\n","      <th>Low_x</th>\n","      <th>Close_x</th>\n","      <th>Adj Close_x</th>\n","      <th>RSI</th>\n","      <th>SMA</th>\n","      <th>EMA</th>\n","      <th>EMAF</th>\n","      <th>EMAM</th>\n","      <th>EMAS</th>\n","      <th>MACD_12_26_9</th>\n","      <th>MACDh_12_26_9</th>\n","      <th>MACDs_12_26_9</th>\n","      <th>BBL_12_2.0</th>\n","      <th>BBM_12_2.0</th>\n","      <th>BBU_12_2.0</th>\n","      <th>BBB_12_2.0</th>\n","      <th>BBP_12_2.0</th>\n","      <th>ADX_20</th>\n","      <th>DMP_20</th>\n","      <th>DMN_20</th>\n","      <th>ROC_12</th>\n","      <th>sentiment</th>\n","      <th>returnsclass</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>2013-12-16</td>\n","      <td>1.373815</td>\n","      <td>1.379900</td>\n","      <td>1.373815</td>\n","      <td>1.373928</td>\n","      <td>1.373928</td>\n","      <td>61.180787</td>\n","      <td>1.368764</td>\n","      <td>1.369946</td>\n","      <td>1.364524</td>\n","      <td>1.347592</td>\n","      <td>1.339880</td>\n","      <td>0.005894</td>\n","      <td>0.002006</td>\n","      <td>0.003889</td>\n","      <td>1.350766</td>\n","      <td>1.367213</td>\n","      <td>1.383660</td>\n","      <td>2.405920</td>\n","      <td>0.704164</td>\n","      <td>15.357994</td>\n","      <td>22.396920</td>\n","      <td>14.854837</td>\n","      <td>1.220049</td>\n","      <td>-0.014925</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2013-12-17</td>\n","      <td>1.376178</td>\n","      <td>1.378210</td>\n","      <td>1.372701</td>\n","      <td>1.376292</td>\n","      <td>1.376292</td>\n","      <td>62.811095</td>\n","      <td>1.370973</td>\n","      <td>1.371100</td>\n","      <td>1.365645</td>\n","      <td>1.348160</td>\n","      <td>1.340363</td>\n","      <td>0.006076</td>\n","      <td>0.001750</td>\n","      <td>0.004326</td>\n","      <td>1.351940</td>\n","      <td>1.368537</td>\n","      <td>1.385135</td>\n","      <td>2.425581</td>\n","      <td>0.733614</td>\n","      <td>15.493713</td>\n","      <td>21.662505</td>\n","      <td>15.031101</td>\n","      <td>1.168472</td>\n","      <td>-0.108911</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2013-12-18</td>\n","      <td>1.377107</td>\n","      <td>1.378099</td>\n","      <td>1.373479</td>\n","      <td>1.377126</td>\n","      <td>1.377126</td>\n","      <td>63.392301</td>\n","      <td>1.372779</td>\n","      <td>1.372196</td>\n","      <td>1.366738</td>\n","      <td>1.348734</td>\n","      <td>1.340849</td>\n","      <td>0.006216</td>\n","      <td>0.001512</td>\n","      <td>0.004704</td>\n","      <td>1.354059</td>\n","      <td>1.370088</td>\n","      <td>1.386118</td>\n","      <td>2.339867</td>\n","      <td>0.719524</td>\n","      <td>15.622646</td>\n","      <td>21.053065</td>\n","      <td>14.608225</td>\n","      <td>1.370242</td>\n","      <td>-0.006410</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>2013-12-19</td>\n","      <td>1.368307</td>\n","      <td>1.369394</td>\n","      <td>1.365113</td>\n","      <td>1.368495</td>\n","      <td>1.368495</td>\n","      <td>54.028961</td>\n","      <td>1.373764</td>\n","      <td>1.371523</td>\n","      <td>1.366905</td>\n","      <td>1.349125</td>\n","      <td>1.341216</td>\n","      <td>0.005567</td>\n","      <td>0.000690</td>\n","      <td>0.004877</td>\n","      <td>1.358317</td>\n","      <td>1.371279</td>\n","      <td>1.384242</td>\n","      <td>1.890574</td>\n","      <td>0.392590</td>\n","      <td>14.973438</td>\n","      <td>19.547899</td>\n","      <td>18.542880</td>\n","      <td>1.055106</td>\n","      <td>0.068493</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>2013-12-20</td>\n","      <td>1.365598</td>\n","      <td>1.370870</td>\n","      <td>1.362583</td>\n","      <td>1.365579</td>\n","      <td>1.365579</td>\n","      <td>51.287513</td>\n","      <td>1.373623</td>\n","      <td>1.370442</td>\n","      <td>1.366779</td>\n","      <td>1.349451</td>\n","      <td>1.341538</td>\n","      <td>0.004762</td>\n","      <td>-0.000092</td>\n","      <td>0.004854</td>\n","      <td>1.360510</td>\n","      <td>1.371822</td>\n","      <td>1.383133</td>\n","      <td>1.649117</td>\n","      <td>0.224048</td>\n","      <td>14.297832</td>\n","      <td>18.583230</td>\n","      <td>19.134403</td>\n","      <td>0.479314</td>\n","      <td>-0.074380</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>2316</th>\n","      <td>2022-11-04</td>\n","      <td>0.974963</td>\n","      <td>0.993818</td>\n","      <td>0.974849</td>\n","      <td>0.974963</td>\n","      <td>0.974963</td>\n","      <td>43.011123</td>\n","      <td>0.990533</td>\n","      <td>0.986115</td>\n","      <td>0.985942</td>\n","      <td>1.007830</td>\n","      <td>1.025200</td>\n","      <td>-0.000073</td>\n","      <td>-0.000374</td>\n","      <td>0.000301</td>\n","      <td>0.969172</td>\n","      <td>0.988323</td>\n","      <td>1.007473</td>\n","      <td>3.875445</td>\n","      <td>0.151205</td>\n","      <td>10.588025</td>\n","      <td>18.945042</td>\n","      <td>19.588859</td>\n","      <td>-1.158250</td>\n","      <td>-0.120438</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2317</th>\n","      <td>2022-11-07</td>\n","      <td>0.992881</td>\n","      <td>1.000500</td>\n","      <td>0.991945</td>\n","      <td>0.992881</td>\n","      <td>0.992881</td>\n","      <td>53.118878</td>\n","      <td>0.991220</td>\n","      <td>0.987345</td>\n","      <td>0.986603</td>\n","      <td>1.007534</td>\n","      <td>1.024771</td>\n","      <td>0.000468</td>\n","      <td>0.000133</td>\n","      <td>0.000335</td>\n","      <td>0.971761</td>\n","      <td>0.989675</td>\n","      <td>1.007590</td>\n","      <td>3.620319</td>\n","      <td>0.589474</td>\n","      <td>10.311693</td>\n","      <td>19.627748</td>\n","      <td>17.736596</td>\n","      <td>1.662092</td>\n","      <td>-0.213805</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2318</th>\n","      <td>2022-11-08</td>\n","      <td>1.001863</td>\n","      <td>1.009418</td>\n","      <td>0.997606</td>\n","      <td>1.001863</td>\n","      <td>1.001863</td>\n","      <td>57.196524</td>\n","      <td>0.992542</td>\n","      <td>0.989985</td>\n","      <td>0.988056</td>\n","      <td>1.007421</td>\n","      <td>1.024468</td>\n","      <td>0.001603</td>\n","      <td>0.001014</td>\n","      <td>0.000588</td>\n","      <td>0.974118</td>\n","      <td>0.991673</td>\n","      <td>1.009228</td>\n","      <td>3.540559</td>\n","      <td>0.790236</td>\n","      <td>10.453165</td>\n","      <td>21.704507</td>\n","      <td>16.662629</td>\n","      <td>2.451556</td>\n","      <td>-0.148820</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2319</th>\n","      <td>2022-11-09</td>\n","      <td>1.008085</td>\n","      <td>1.008878</td>\n","      <td>1.001252</td>\n","      <td>1.008085</td>\n","      <td>1.008085</td>\n","      <td>59.791762</td>\n","      <td>0.993713</td>\n","      <td>0.993276</td>\n","      <td>0.989964</td>\n","      <td>1.007435</td>\n","      <td>1.024251</td>\n","      <td>0.002970</td>\n","      <td>0.001905</td>\n","      <td>0.001065</td>\n","      <td>0.974180</td>\n","      <td>0.993513</td>\n","      <td>1.012845</td>\n","      <td>3.891718</td>\n","      <td>0.876882</td>\n","      <td>10.587564</td>\n","      <td>21.084724</td>\n","      <td>16.186820</td>\n","      <td>2.238945</td>\n","      <td>-0.138081</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2320</th>\n","      <td>2022-11-10</td>\n","      <td>1.001954</td>\n","      <td>1.018299</td>\n","      <td>0.993779</td>\n","      <td>1.001954</td>\n","      <td>1.001954</td>\n","      <td>56.194274</td>\n","      <td>0.992989</td>\n","      <td>0.994854</td>\n","      <td>0.991106</td>\n","      <td>1.007326</td>\n","      <td>1.023956</td>\n","      <td>0.003518</td>\n","      <td>0.001963</td>\n","      <td>0.001555</td>\n","      <td>0.975008</td>\n","      <td>0.994621</td>\n","      <td>1.014235</td>\n","      <td>3.943934</td>\n","      <td>0.686923</td>\n","      <td>11.108691</td>\n","      <td>22.612443</td>\n","      <td>14.760371</td>\n","      <td>1.345624</td>\n","      <td>-0.173095</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>2321 rows × 26 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b17c6755-db0b-4fd1-9a0c-ddebc3968de1')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-b17c6755-db0b-4fd1-9a0c-ddebc3968de1 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-b17c6755-db0b-4fd1-9a0c-ddebc3968de1');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":74}]},{"cell_type":"code","source":["data_final = data_final.set_index(['Date'])\n","data_final"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":0},"id":"0l7RYWoZbbzB","executionInfo":{"status":"ok","timestamp":1684138667917,"user_tz":-540,"elapsed":10,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}},"outputId":"bb007224-fe7d-4df1-aa37-16df88dd2882"},"execution_count":75,"outputs":[{"output_type":"execute_result","data":{"text/plain":["              Open_x    High_x     Low_x   Close_x  Adj Close_x        RSI  \\\n","Date                                                                         \n","2013-12-16  1.373815  1.379900  1.373815  1.373928     1.373928  61.180787   \n","2013-12-17  1.376178  1.378210  1.372701  1.376292     1.376292  62.811095   \n","2013-12-18  1.377107  1.378099  1.373479  1.377126     1.377126  63.392301   \n","2013-12-19  1.368307  1.369394  1.365113  1.368495     1.368495  54.028961   \n","2013-12-20  1.365598  1.370870  1.362583  1.365579     1.365579  51.287513   \n","...              ...       ...       ...       ...          ...        ...   \n","2022-11-04  0.974963  0.993818  0.974849  0.974963     0.974963  43.011123   \n","2022-11-07  0.992881  1.000500  0.991945  0.992881     0.992881  53.118878   \n","2022-11-08  1.001863  1.009418  0.997606  1.001863     1.001863  57.196524   \n","2022-11-09  1.008085  1.008878  1.001252  1.008085     1.008085  59.791762   \n","2022-11-10  1.001954  1.018299  0.993779  1.001954     1.001954  56.194274   \n","\n","                 SMA       EMA      EMAF      EMAM      EMAS  MACD_12_26_9  \\\n","Date                                                                         \n","2013-12-16  1.368764  1.369946  1.364524  1.347592  1.339880      0.005894   \n","2013-12-17  1.370973  1.371100  1.365645  1.348160  1.340363      0.006076   \n","2013-12-18  1.372779  1.372196  1.366738  1.348734  1.340849      0.006216   \n","2013-12-19  1.373764  1.371523  1.366905  1.349125  1.341216      0.005567   \n","2013-12-20  1.373623  1.370442  1.366779  1.349451  1.341538      0.004762   \n","...              ...       ...       ...       ...       ...           ...   \n","2022-11-04  0.990533  0.986115  0.985942  1.007830  1.025200     -0.000073   \n","2022-11-07  0.991220  0.987345  0.986603  1.007534  1.024771      0.000468   \n","2022-11-08  0.992542  0.989985  0.988056  1.007421  1.024468      0.001603   \n","2022-11-09  0.993713  0.993276  0.989964  1.007435  1.024251      0.002970   \n","2022-11-10  0.992989  0.994854  0.991106  1.007326  1.023956      0.003518   \n","\n","            MACDh_12_26_9  MACDs_12_26_9  BBL_12_2.0  BBM_12_2.0  BBU_12_2.0  \\\n","Date                                                                           \n","2013-12-16       0.002006       0.003889    1.350766    1.367213    1.383660   \n","2013-12-17       0.001750       0.004326    1.351940    1.368537    1.385135   \n","2013-12-18       0.001512       0.004704    1.354059    1.370088    1.386118   \n","2013-12-19       0.000690       0.004877    1.358317    1.371279    1.384242   \n","2013-12-20      -0.000092       0.004854    1.360510    1.371822    1.383133   \n","...                   ...            ...         ...         ...         ...   \n","2022-11-04      -0.000374       0.000301    0.969172    0.988323    1.007473   \n","2022-11-07       0.000133       0.000335    0.971761    0.989675    1.007590   \n","2022-11-08       0.001014       0.000588    0.974118    0.991673    1.009228   \n","2022-11-09       0.001905       0.001065    0.974180    0.993513    1.012845   \n","2022-11-10       0.001963       0.001555    0.975008    0.994621    1.014235   \n","\n","            BBB_12_2.0  BBP_12_2.0     ADX_20     DMP_20     DMN_20    ROC_12  \\\n","Date                                                                            \n","2013-12-16    2.405920    0.704164  15.357994  22.396920  14.854837  1.220049   \n","2013-12-17    2.425581    0.733614  15.493713  21.662505  15.031101  1.168472   \n","2013-12-18    2.339867    0.719524  15.622646  21.053065  14.608225  1.370242   \n","2013-12-19    1.890574    0.392590  14.973438  19.547899  18.542880  1.055106   \n","2013-12-20    1.649117    0.224048  14.297832  18.583230  19.134403  0.479314   \n","...                ...         ...        ...        ...        ...       ...   \n","2022-11-04    3.875445    0.151205  10.588025  18.945042  19.588859 -1.158250   \n","2022-11-07    3.620319    0.589474  10.311693  19.627748  17.736596  1.662092   \n","2022-11-08    3.540559    0.790236  10.453165  21.704507  16.662629  2.451556   \n","2022-11-09    3.891718    0.876882  10.587564  21.084724  16.186820  2.238945   \n","2022-11-10    3.943934    0.686923  11.108691  22.612443  14.760371  1.345624   \n","\n","            sentiment  returnsclass  \n","Date                                 \n","2013-12-16  -0.014925             0  \n","2013-12-17  -0.108911             1  \n","2013-12-18  -0.006410             1  \n","2013-12-19   0.068493             0  \n","2013-12-20  -0.074380             0  \n","...               ...           ...  \n","2022-11-04  -0.120438             0  \n","2022-11-07  -0.213805             1  \n","2022-11-08  -0.148820             1  \n","2022-11-09  -0.138081             1  \n","2022-11-10  -0.173095             0  \n","\n","[2321 rows x 25 columns]"],"text/html":["\n","  <div id=\"df-7b3bb8a7-44b7-4059-8459-c79f565a57cb\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Open_x</th>\n","      <th>High_x</th>\n","      <th>Low_x</th>\n","      <th>Close_x</th>\n","      <th>Adj Close_x</th>\n","      <th>RSI</th>\n","      <th>SMA</th>\n","      <th>EMA</th>\n","      <th>EMAF</th>\n","      <th>EMAM</th>\n","      <th>EMAS</th>\n","      <th>MACD_12_26_9</th>\n","      <th>MACDh_12_26_9</th>\n","      <th>MACDs_12_26_9</th>\n","      <th>BBL_12_2.0</th>\n","      <th>BBM_12_2.0</th>\n","      <th>BBU_12_2.0</th>\n","      <th>BBB_12_2.0</th>\n","      <th>BBP_12_2.0</th>\n","      <th>ADX_20</th>\n","      <th>DMP_20</th>\n","      <th>DMN_20</th>\n","      <th>ROC_12</th>\n","      <th>sentiment</th>\n","      <th>returnsclass</th>\n","    </tr>\n","    <tr>\n","      <th>Date</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>2013-12-16</th>\n","      <td>1.373815</td>\n","      <td>1.379900</td>\n","      <td>1.373815</td>\n","      <td>1.373928</td>\n","      <td>1.373928</td>\n","      <td>61.180787</td>\n","      <td>1.368764</td>\n","      <td>1.369946</td>\n","      <td>1.364524</td>\n","      <td>1.347592</td>\n","      <td>1.339880</td>\n","      <td>0.005894</td>\n","      <td>0.002006</td>\n","      <td>0.003889</td>\n","      <td>1.350766</td>\n","      <td>1.367213</td>\n","      <td>1.383660</td>\n","      <td>2.405920</td>\n","      <td>0.704164</td>\n","      <td>15.357994</td>\n","      <td>22.396920</td>\n","      <td>14.854837</td>\n","      <td>1.220049</td>\n","      <td>-0.014925</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2013-12-17</th>\n","      <td>1.376178</td>\n","      <td>1.378210</td>\n","      <td>1.372701</td>\n","      <td>1.376292</td>\n","      <td>1.376292</td>\n","      <td>62.811095</td>\n","      <td>1.370973</td>\n","      <td>1.371100</td>\n","      <td>1.365645</td>\n","      <td>1.348160</td>\n","      <td>1.340363</td>\n","      <td>0.006076</td>\n","      <td>0.001750</td>\n","      <td>0.004326</td>\n","      <td>1.351940</td>\n","      <td>1.368537</td>\n","      <td>1.385135</td>\n","      <td>2.425581</td>\n","      <td>0.733614</td>\n","      <td>15.493713</td>\n","      <td>21.662505</td>\n","      <td>15.031101</td>\n","      <td>1.168472</td>\n","      <td>-0.108911</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2013-12-18</th>\n","      <td>1.377107</td>\n","      <td>1.378099</td>\n","      <td>1.373479</td>\n","      <td>1.377126</td>\n","      <td>1.377126</td>\n","      <td>63.392301</td>\n","      <td>1.372779</td>\n","      <td>1.372196</td>\n","      <td>1.366738</td>\n","      <td>1.348734</td>\n","      <td>1.340849</td>\n","      <td>0.006216</td>\n","      <td>0.001512</td>\n","      <td>0.004704</td>\n","      <td>1.354059</td>\n","      <td>1.370088</td>\n","      <td>1.386118</td>\n","      <td>2.339867</td>\n","      <td>0.719524</td>\n","      <td>15.622646</td>\n","      <td>21.053065</td>\n","      <td>14.608225</td>\n","      <td>1.370242</td>\n","      <td>-0.006410</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2013-12-19</th>\n","      <td>1.368307</td>\n","      <td>1.369394</td>\n","      <td>1.365113</td>\n","      <td>1.368495</td>\n","      <td>1.368495</td>\n","      <td>54.028961</td>\n","      <td>1.373764</td>\n","      <td>1.371523</td>\n","      <td>1.366905</td>\n","      <td>1.349125</td>\n","      <td>1.341216</td>\n","      <td>0.005567</td>\n","      <td>0.000690</td>\n","      <td>0.004877</td>\n","      <td>1.358317</td>\n","      <td>1.371279</td>\n","      <td>1.384242</td>\n","      <td>1.890574</td>\n","      <td>0.392590</td>\n","      <td>14.973438</td>\n","      <td>19.547899</td>\n","      <td>18.542880</td>\n","      <td>1.055106</td>\n","      <td>0.068493</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2013-12-20</th>\n","      <td>1.365598</td>\n","      <td>1.370870</td>\n","      <td>1.362583</td>\n","      <td>1.365579</td>\n","      <td>1.365579</td>\n","      <td>51.287513</td>\n","      <td>1.373623</td>\n","      <td>1.370442</td>\n","      <td>1.366779</td>\n","      <td>1.349451</td>\n","      <td>1.341538</td>\n","      <td>0.004762</td>\n","      <td>-0.000092</td>\n","      <td>0.004854</td>\n","      <td>1.360510</td>\n","      <td>1.371822</td>\n","      <td>1.383133</td>\n","      <td>1.649117</td>\n","      <td>0.224048</td>\n","      <td>14.297832</td>\n","      <td>18.583230</td>\n","      <td>19.134403</td>\n","      <td>0.479314</td>\n","      <td>-0.074380</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-04</th>\n","      <td>0.974963</td>\n","      <td>0.993818</td>\n","      <td>0.974849</td>\n","      <td>0.974963</td>\n","      <td>0.974963</td>\n","      <td>43.011123</td>\n","      <td>0.990533</td>\n","      <td>0.986115</td>\n","      <td>0.985942</td>\n","      <td>1.007830</td>\n","      <td>1.025200</td>\n","      <td>-0.000073</td>\n","      <td>-0.000374</td>\n","      <td>0.000301</td>\n","      <td>0.969172</td>\n","      <td>0.988323</td>\n","      <td>1.007473</td>\n","      <td>3.875445</td>\n","      <td>0.151205</td>\n","      <td>10.588025</td>\n","      <td>18.945042</td>\n","      <td>19.588859</td>\n","      <td>-1.158250</td>\n","      <td>-0.120438</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-07</th>\n","      <td>0.992881</td>\n","      <td>1.000500</td>\n","      <td>0.991945</td>\n","      <td>0.992881</td>\n","      <td>0.992881</td>\n","      <td>53.118878</td>\n","      <td>0.991220</td>\n","      <td>0.987345</td>\n","      <td>0.986603</td>\n","      <td>1.007534</td>\n","      <td>1.024771</td>\n","      <td>0.000468</td>\n","      <td>0.000133</td>\n","      <td>0.000335</td>\n","      <td>0.971761</td>\n","      <td>0.989675</td>\n","      <td>1.007590</td>\n","      <td>3.620319</td>\n","      <td>0.589474</td>\n","      <td>10.311693</td>\n","      <td>19.627748</td>\n","      <td>17.736596</td>\n","      <td>1.662092</td>\n","      <td>-0.213805</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-08</th>\n","      <td>1.001863</td>\n","      <td>1.009418</td>\n","      <td>0.997606</td>\n","      <td>1.001863</td>\n","      <td>1.001863</td>\n","      <td>57.196524</td>\n","      <td>0.992542</td>\n","      <td>0.989985</td>\n","      <td>0.988056</td>\n","      <td>1.007421</td>\n","      <td>1.024468</td>\n","      <td>0.001603</td>\n","      <td>0.001014</td>\n","      <td>0.000588</td>\n","      <td>0.974118</td>\n","      <td>0.991673</td>\n","      <td>1.009228</td>\n","      <td>3.540559</td>\n","      <td>0.790236</td>\n","      <td>10.453165</td>\n","      <td>21.704507</td>\n","      <td>16.662629</td>\n","      <td>2.451556</td>\n","      <td>-0.148820</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-09</th>\n","      <td>1.008085</td>\n","      <td>1.008878</td>\n","      <td>1.001252</td>\n","      <td>1.008085</td>\n","      <td>1.008085</td>\n","      <td>59.791762</td>\n","      <td>0.993713</td>\n","      <td>0.993276</td>\n","      <td>0.989964</td>\n","      <td>1.007435</td>\n","      <td>1.024251</td>\n","      <td>0.002970</td>\n","      <td>0.001905</td>\n","      <td>0.001065</td>\n","      <td>0.974180</td>\n","      <td>0.993513</td>\n","      <td>1.012845</td>\n","      <td>3.891718</td>\n","      <td>0.876882</td>\n","      <td>10.587564</td>\n","      <td>21.084724</td>\n","      <td>16.186820</td>\n","      <td>2.238945</td>\n","      <td>-0.138081</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2022-11-10</th>\n","      <td>1.001954</td>\n","      <td>1.018299</td>\n","      <td>0.993779</td>\n","      <td>1.001954</td>\n","      <td>1.001954</td>\n","      <td>56.194274</td>\n","      <td>0.992989</td>\n","      <td>0.994854</td>\n","      <td>0.991106</td>\n","      <td>1.007326</td>\n","      <td>1.023956</td>\n","      <td>0.003518</td>\n","      <td>0.001963</td>\n","      <td>0.001555</td>\n","      <td>0.975008</td>\n","      <td>0.994621</td>\n","      <td>1.014235</td>\n","      <td>3.943934</td>\n","      <td>0.686923</td>\n","      <td>11.108691</td>\n","      <td>22.612443</td>\n","      <td>14.760371</td>\n","      <td>1.345624</td>\n","      <td>-0.173095</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>2321 rows × 25 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7b3bb8a7-44b7-4059-8459-c79f565a57cb')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-7b3bb8a7-44b7-4059-8459-c79f565a57cb button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-7b3bb8a7-44b7-4059-8459-c79f565a57cb');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":75}]},{"cell_type":"markdown","source":["## **SUPPORT VECTOR MACHINE**"],"metadata":{"id":"tatozSaGbET4"}},{"cell_type":"code","source":["# Separate the features (historical prices and technical indicators) and the target (movement)\n","features = data_final.iloc[:, :-1]\n","target = data_final['returnsclass'].values"],"metadata":{"id":"8tlYckoUbp-a","executionInfo":{"status":"ok","timestamp":1684138670883,"user_tz":-540,"elapsed":292,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"execution_count":76,"outputs":[]},{"cell_type":"code","source":["# Scale the features\n","scaler = MinMaxScaler()\n","scaled_features = scaler.fit_transform(features)"],"metadata":{"id":"CJOMj_WiburF","executionInfo":{"status":"ok","timestamp":1684138670884,"user_tz":-540,"elapsed":5,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"execution_count":77,"outputs":[]},{"cell_type":"code","source":["# Split the data into training and test sets\n","X_train, X_test, y_train, y_test = train_test_split(scaled_features, target, test_size=0.2, random_state=42)"],"metadata":{"id":"t3RgvxEZbwjD","executionInfo":{"status":"ok","timestamp":1684138670884,"user_tz":-540,"elapsed":5,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"execution_count":78,"outputs":[]},{"cell_type":"code","source":["# Create and train the SVM model\n","model = SVC(kernel='rbf')\n","model.fit(X_train, y_train)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":75},"id":"U7F2VeRUbyrI","executionInfo":{"status":"ok","timestamp":1684138671840,"user_tz":-540,"elapsed":960,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}},"outputId":"a243d80d-b90b-488a-bfcc-a61af7c14490"},"execution_count":79,"outputs":[{"output_type":"execute_result","data":{"text/plain":["SVC()"],"text/html":["<style>#sk-container-id-2 {color: black;background-color: white;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-2\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>SVC()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-2\" type=\"checkbox\" checked><label for=\"sk-estimator-id-2\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">SVC</label><div class=\"sk-toggleable__content\"><pre>SVC()</pre></div></div></div></div></div>"]},"metadata":{},"execution_count":79}]},{"cell_type":"code","source":["# Make predictions on the test set\n","y_pred = model.predict(X_test)"],"metadata":{"id":"29tr_S5Rb2YR","executionInfo":{"status":"ok","timestamp":1684138671840,"user_tz":-540,"elapsed":8,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}}},"execution_count":80,"outputs":[]},{"cell_type":"code","source":["# Calculate the accuracy of the model\n","accuracy = accuracy_score(y_test, y_pred)\n","print(f'Test Accuracy: {accuracy}')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"nij1OSW8b3zG","executionInfo":{"status":"ok","timestamp":1684138671841,"user_tz":-540,"elapsed":9,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}},"outputId":"59cff570-f42b-4b86-ff52-6c0302752fa6"},"execution_count":81,"outputs":[{"output_type":"stream","name":"stdout","text":["Test Accuracy: 0.7032258064516129\n"]}]},{"cell_type":"code","source":["# Calculate the classification report\n","report = classification_report(y_test, y_pred, digits = 4)\n","print(\"Classification Report:\")\n","print(report)\n","\n","# Calculate the confusion matrix\n","matrix = confusion_matrix(y_test, y_pred)\n","print(\"Confusion Matrix:\")\n","print(matrix)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"MlT_Rukeb55r","executionInfo":{"status":"ok","timestamp":1684138671841,"user_tz":-540,"elapsed":7,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}},"outputId":"6c4b7d2b-76a3-4ad9-e26c-bf7171e0a932"},"execution_count":82,"outputs":[{"output_type":"stream","name":"stdout","text":["Classification Report:\n","              precision    recall  f1-score   support\n","\n","           0     0.6844    0.7325    0.7076       228\n","           1     0.7240    0.6751    0.6987       237\n","\n","    accuracy                         0.7032       465\n","   macro avg     0.7042    0.7038    0.7032       465\n","weighted avg     0.7046    0.7032    0.7031       465\n","\n","Confusion Matrix:\n","[[167  61]\n"," [ 77 160]]\n"]}]},{"cell_type":"code","source":["# Prepare the input data for prediction (assuming X_test represents the most recent data available)\n","input_data = scaled_features[-1]  # Select the most recent data point as input data\n","\n","# Make the prediction\n","prediction = model.predict([input_data])\n","\n","# Interpret the prediction\n","if prediction == 1:\n","    price_movement = \"Positive\"\n","else:\n","    price_movement = \"Negative\"\n","\n","# Print the predicted price movement\n","print(\"Next day's price movement:\", price_movement)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2shDHsg4b8by","executionInfo":{"status":"ok","timestamp":1684138671842,"user_tz":-540,"elapsed":6,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}},"outputId":"5733e724-5391-45a5-d999-d7432f5efbd9"},"execution_count":83,"outputs":[{"output_type":"stream","name":"stdout","text":["Next day's price movement: Positive\n"]}]},{"cell_type":"markdown","source":["## OTHER METHODS"],"metadata":{"id":"n2XzQ5QHbEt9"}},{"cell_type":"code","source":["X2= data_final.iloc[:,0:24]"],"metadata":{"id":"2Z1xabMTqq0K"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["Y2 = data_final['returnsclass']"],"metadata":{"id":"UTUioOb_q1un"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["X2 = standardizer.fit_transform(X2)"],"metadata":{"id":"1C1Bfl9Sq4JC"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["X2_train, X2_test, Y2_train, Y2_test = train_test_split(X2, Y2, test_size = 0.15, shuffle = False)"],"metadata":{"id":"ArJ1Q72Rq-vv"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["#Importing each model\n","\n","models = {}\n","\n","# Logistic Regression\n","from sklearn.linear_model import LogisticRegression\n","models['Logistic Regression'] = LogisticRegression()\n","\n","# Support Vector Machines\n","from sklearn.svm import LinearSVC\n","models['Support Vector Machines'] = LinearSVC()\n","\n","# Decision Trees\n","from sklearn.tree import DecisionTreeClassifier\n","models['Decision Trees'] = DecisionTreeClassifier()\n","\n","# Random Forest\n","from sklearn.ensemble import RandomForestClassifier\n","models['Random Forest'] = RandomForestClassifier()\n","\n","# Naive Bayes\n","from sklearn.naive_bayes import GaussianNB\n","models['Naive Bayes'] = GaussianNB()\n","\n","# K-Nearest Neighbors\n","from sklearn.neighbors import KNeighborsClassifier\n","models['K-Nearest Neighbor'] = KNeighborsClassifier()"],"metadata":{"id":"Uf7sbZ32rEXM"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["#Calculating their accuracy, precision, and recall\n","from sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score\n","\n","accuracy, precision, recall, f1 = {}, {}, {}, {}\n","\n","for key in models.keys():\n","    \n","    # Fit the classifier model\n","    models[key].fit(X2_train, Y2_train)\n","    \n","    # Prediction \n","    predictions = models[key].predict(X2_test)\n","    \n","    # Calculate Accuracy, Precision and Recall Metrics\n","    accuracy[key] = accuracy_score(predictions, Y2_test)\n","    precision[key] = precision_score(predictions, Y2_test)\n","    recall[key] = recall_score(predictions, Y2_test)\n","    f1[key]= f1_score(predictions, Y2_test)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"xIPlWPBObv70","executionInfo":{"status":"ok","timestamp":1683634128456,"user_tz":-540,"elapsed":3676,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}},"outputId":"e88723f7-aeb6-4189-c31c-39c6faca35f7"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/sklearn/svm/_base.py:1244: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.\n","  warnings.warn(\n"]}]},{"cell_type":"code","source":["#Printing assessments of each model\n","df_model = pd.DataFrame(index = models.keys(), columns = ['Accuracy', 'Precision', 'Recall', 'f1'])\n","df_model['Accuracy'] = accuracy.values()\n","df_model['Precision'] = precision.values()\n","df_model['Recall'] = recall.values()\n","df_model['f1'] = f1.values()\n","df_model"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":238},"id":"i1ZTrlavb0On","executionInfo":{"status":"ok","timestamp":1683634131846,"user_tz":-540,"elapsed":370,"user":{"displayName":"Ｔｈｕ Ｔｒａｎｇ ＮＧＵＹＥＮ","userId":"09101496368185663287"}},"outputId":"06b3d290-98c0-4701-8d10-cc34e1229744"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                         Accuracy  Precision    Recall        f1\n","Logistic Regression      0.762178   0.662577  0.794118  0.722408\n","Support Vector Machines  0.787966   0.717791  0.806897  0.759740\n","Decision Trees           0.595989   0.496933  0.578571  0.534653\n","Random Forest            0.659026   0.527607  0.671875  0.591065\n","Naive Bayes              0.604585   0.355828  0.637363  0.456693\n","K-Nearest Neighbor       0.653295   0.588957  0.640000  0.613419"],"text/html":["\n","  <div id=\"df-a12656bd-c3f9-407e-b290-860571b50c33\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Accuracy</th>\n","      <th>Precision</th>\n","      <th>Recall</th>\n","      <th>f1</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>Logistic Regression</th>\n","      <td>0.762178</td>\n","      <td>0.662577</td>\n","      <td>0.794118</td>\n","      <td>0.722408</td>\n","    </tr>\n","    <tr>\n","      <th>Support Vector Machines</th>\n","      <td>0.787966</td>\n","      <td>0.717791</td>\n","      <td>0.806897</td>\n","      <td>0.759740</td>\n","    </tr>\n","    <tr>\n","      <th>Decision Trees</th>\n","      <td>0.595989</td>\n","      <td>0.496933</td>\n","      <td>0.578571</td>\n","      <td>0.534653</td>\n","    </tr>\n","    <tr>\n","      <th>Random Forest</th>\n","      <td>0.659026</td>\n","      <td>0.527607</td>\n","      <td>0.671875</td>\n","      <td>0.591065</td>\n","    </tr>\n","    <tr>\n","      <th>Naive Bayes</th>\n","      <td>0.604585</td>\n","      <td>0.355828</td>\n","      <td>0.637363</td>\n","      <td>0.456693</td>\n","    </tr>\n","    <tr>\n","      <th>K-Nearest Neighbor</th>\n","      <td>0.653295</td>\n","      <td>0.588957</td>\n","      <td>0.640000</td>\n","      <td>0.613419</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a12656bd-c3f9-407e-b290-860571b50c33')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a12656bd-c3f9-407e-b290-860571b50c33 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a12656bd-c3f9-407e-b290-860571b50c33');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":70}]}],"metadata":{"colab":{"provenance":[],"collapsed_sections":["rfE2a5LqSsNW","9Yuw8bQTa1fq","xNwhPj_pcxcD","d6SRjRZ6dENa","WR59PkXWVCCU","wfnuvqrxVkHZ","VM6wNr00bWTI","tatozSaGbET4","n2XzQ5QHbEt9"],"authorship_tag":"ABX9TyPINkNHHwIjWRdvjoMk4HSS"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}